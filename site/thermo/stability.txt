\field{熱力学}
\title{状態の安定性}
\comment{毎度、表現が大袈裟なのは気にしないように。<br>学習意欲を煽るのが目的なので……。}
\prev{direction}
\next{two_phase}
\create{2005/1/21}
\modify{2023/12/7 9:40}


\section{安定とは何か}


　自然は安定な状態を「好む」のだろうか。
　こういう考え方をしているなら見方を変えた方がいい。
　ある状態から抜け出しにくい時、その状態を安定であると人は考えるのである。
　つまり自然が好むかどうかは関係無く、
ただなかなか抜け出せないからその状態にとどまっているだけだととらえるべきである。
　安定なんていう概念はそれだけのものだ。

<P>

　山の頂上にあるボールと、谷底にあるボールと、どちらが安定かと言えば、谷底の方である。
前回も言ったが、自然がエネルギーの低い方を好んでいるのではない。
谷底では少し移動すると元の位置に戻す方向に力が働くので、
ボールは仕方なくその辺りの位置でうろうろするしかないだけだ。
それを人間の言葉で解釈すれば、「エネルギーが低い方が安定である」となるのである。

<P>

　状況により様々であって、これは基本法則などではない。
エネルギーが低い時ばかりが安定だとは限らない。


% ==========================================================================

\section{熱力学的な安定}

　前回は「断熱」「等温かつ定積」「等温かつ定圧」の条件下でそれぞれ、

<tex>
dS\ \geqq\ 0 \\
dF\ \leqq\ 0 \\
dG\ \leqq\ 0 
</tex>

という不等式が成り立っていることを導いた。
これらを使って、物質がどういう状態で安定して存在するかを調べる事が出来る。

<P>

　例えば断熱条件で不可逆変化が起こるとエントロピー$ S $は必ず増大する。
不可逆変化なので$ S $が増大した状態からは自然には戻ってこない事を意味する。
もしエントロピーが極大であるような状態に一度到達すれば、そこから他の状態へは変化しようがない。
つまりそこが安定した状態なのだ。

<P>

　同様に「等温かつ定積」の条件では$ F $が極小になる状態が安定である。
この条件下ではエントロピー$ S $は不可逆変化以外の理由でも上下するので、$ S $の極大で判断するわけにはいかないのだった。

<P>

　同様に「等温かつ定圧」の条件では$ G $が極小になる状態に落ち着く。

<P>

　しかし系はこれらの関数$ S $、$ F $、$ G $の値の「変化」が最も急になるような道筋を選んで状態変化するわけではない。
斜面に置かれたボールの振る舞いとはちょっと違う。
もし仮に関数値の変化が急であるような道筋を選んだとしても、状態変化にかかる時間が短くなるというわけでもない。
状態図の上の距離は現実の時間とはまったく関係がないからである。

<P>

　こういうわけで、ある状態から出発して、そこから到達可能な極大、極小点が複数あった場合に、
系が最終的にどの状態にたどり着くか、といったことは熱力学では全く予言できないのである。
熱力学とはそういう学問であって、結果についてその状態が安定かどうかということしか言えない。
しかしそれだけでも色々な事が調べられる。

% =========================================================================

\section{極値判定について}

　関数の極大、極小を求める方法については高校の数学で学んだ事だろう。
まず関数の 1 階微分が 0 になるところを見つけ、
その点での 2 階微分の正負によって下に凸（極小）か、上に凸（極大）かを判断するのだった。
しかし熱力学に出てくる関数は変数が一つではなく複数ある。
そういう場合については恐らく高校では習ってはおるまい。

<P>

　例としてある多変数の関数$ g ( x, y, z ) $を考えよう。
変数$ x $、$ y $、$ z $をそれぞれ、ごくわずか$ \delta x $、$ \delta y $、$ \delta z $だけ変化させた時の関数$ g $の微小変化は

<tex>
\delta g \ =\ \pdif{g}{x}\delta x + \pdif{g}{y}\delta y + \pdif{g}{z}\delta z 
</tex>

と表される。
　いや、実はこれは、そう断言するにはあまり正確ではない。
　この式は、$ \delta x $、$ \delta y $、$ \delta z $に比例するような変化のみを表していて、
これらの 2 乗、3 乗に比例する高次の項を含んでいないからである。
　それでこの変化分は「\red{1 次の変分}」と呼んでおくべきだ。
　変分と言うと専門的に聞こえるが、
「変化分」と呼べばいいものをかっこつけてそう呼んでいるだけなのであまり構えなくてもいい。
　ちなみに、もし変数の変化が無限小なら高次の項は無視できることになり、この式でも十分正確である。
　その場合には変分記号$ \delta $の代わりに、微分記号$ \diff $を使って書いたであろう。
　変分と微分の違いはそういうところだ。

<P>

　高校で習う 1 変数の関数$ f(x) $のグラフが水平となる条件というのは、
$ x $が無限小だけ変化しても$ f $がそれに比例するような大きな変化をしないことであった。
　（極限を取るので$ x $に比例する以外の高次の項は無視してよいのだった。）
　同じように多変数関数$ g $が極値を取るところでは、
$ x $、$ y $、$ z $のいずれを動かしても大きな変化のないことが必要である。
　つまり、この式の全ての項の係数が皆 0 であればいいのである。
　この考えが 1 変数の 1 階微分の代わりに使える。

<P>

　では 2 階微分に相当するものはどう考えればいいだろう。
　2 階微分は「変化分がどう変化するか」という意味だと解釈できるのだった。
　しかし変数が多数あると、それぞれの変数による変化分が、
それぞれの変数に影響されるのであって、非常にややこしいことになる。
　ややこしいだけでそれほど難しくはない。
　実際、次のようになる。

<tex>
\delta^2 g\ =\ \frac{1}{2} &\left( \pddif{g}{x}\delta x^2 + \henbun{g}{x}{y} + \henbun{g}{x}{z} \right. \\
                           &+ \henbun{g}{y}{x} + \pddif{g}{y}\delta y^2 + \henbun{g}{y}{z} \\
                           &+ \left. \henbun{g}{z}{x} + \henbun{g}{z}{y} +\pddif{g}{z}\delta z^2 \right)
</tex>

　これは変数の 2 次の変化に比例する量なので「\red{2 次の変分}」と呼ばれる。
　式の全体に$ \frac{1}{2} $がついているのは、
1 変数のみの関数$ f(x) $のテイラー展開が、

<tex>
f(x+\delta x )\ =\ f(x) + \dif{f(x)}{x}\delta x + \frac{1}{2}\ddif{f(x)}{x} \delta x^2
+ \dots + \frac{1}{n!}\frac{d^n f(x)}{d x^n} \delta x^n + \dots 
</tex>

と表されるのと同じ理屈であって、この式の第 3 項目がそれに相当している。
　変化分が変化に比例しながら加わっていくので、
幾何学的に考えれば三角形の面積を求めるのと同じ形式になっているわけだ。
　この辺りの細かい理屈が気になる人は数学の教科書で調べて欲しい。

<P>

　$ \delta^2 g $がどんな変数の変化に対しても常に正ならばそこは極小点であり、
常に負になるならば極大点だということになる。
　しかしその判定はなかなか難しい。
　もし$ \delta x^2 $、$ \delta y^2 $、$ \delta z^2 $といった 2 乗の項しかなければ、
全ての項の係数が全て正か全て負かという単純な話でいいのだろうが、
$ \delta x\ \delta y $などのような項が含まれている場合は
$ \delta x $が正でも$ \delta y $は負になるかも知れないし、
その場合にその変化が他の項にちゃんと打ち消されるかどうかという判断が非常に面倒だ。
　そのために「\red{ヘッセ行列}」というものを考える。

<tex>
\left( \begin{array}{ccc}
\displaystyle \pddif{g}{x} & \displaystyle \henbibun{g}{x}{y} & \displaystyle \henbibun{g}{x}{z} \\[12pt]
\displaystyle \henbibun{g}{y}{x} & \displaystyle \pddif{g}{y} & \displaystyle \henbibun{g}{y}{z} \\[12pt]
\displaystyle \henbibun{g}{z}{x} & \displaystyle \henbibun{g}{z}{y} & \displaystyle \pddif{g}{z} \\
\end{array}
\right)
</tex>

　「\black{この行列の固有値が全て正値ならば極小で、全て負値ならば極大である。}」
……と言われてもその計算は面倒であって、あまり助けにはならない。
ただ 2 行 2 列の場合、すなわち 2 変数関数の場合に限っては便利な定理がある。
「\black{このヘッセ行列の行列式の値が正であり、かつ行列の左上の成分が正であるなら関数は極小であり、
逆にこの行列の行列式が正であり、
かつ行列の左上の成分が負である時には極大である}」ことが言える。
　細かい部分については線形代数の教科書で「2 次形式」の辺りを調べてみて欲しい。

<P>

　以上が多変数関数の極値判定に関する大まかな状況である。
これらのことを使って二つほど簡単な例題をやってみよう。


% =======================================================================

\section{熱平衡}

　断熱シリンダーに気体が密封されており、
熱を通す壁で二つの部分$ A $、$ B $に仕切られているとする。
　この壁は固定されているとする。

\image{./stability/cylinder.png,二つの部分に仕切られた断熱容器の図}

　全体のエントロピー$ S $は、$ A $、$ B $それぞれの部分のエントロピーの合計であって、

<tex>
S\ =\ S_a( U_a, V_a )\ +\ S_b( U_b, V_b )
</tex>

と表せる。
　ここで$ S $を$ U $と$ V $の関数として表しているのは、
今後の計算に少々都合がいいからであって、
他の変数を選ぶと計算が出来なくなるわけでもない。

<P>

　ここで、$ \delta S $を計算してやると、

<tex>
\delta S = \thdif{S_a}{U_a}{V_a} \!\!\! \delta U_a + \thdif{S_a}{V_a}{U_a} \!\!\! \delta V_a 
         + \thdif{S_b}{U_b}{V_b} \!\!\! \delta U_b + \thdif{S_b}{V_b}{U_b} \!\!\! \delta V_b
</tex>

となるが、今回は体積は変化しないので、

<tex>
=\ \thdif{S_a}{U_a}{V_a} \!\!\! \delta U_a\ +\ \thdif{S_b}{U_b}{V_b} \!\!\! \delta U_b
</tex>

としておけばいい。
　偏微分のところは、<a href="./functions.html">前に導いた</a>関係を使って、

<tex>
=\ \frac{1}{T_a} \delta U_a \ +\ \frac{1}{T_b} \delta U_b
</tex>

と変形できる。
　これは理想気体に限らず成り立つのだった。
　この結果をさらに簡単な形にまとめてやりたい。
　うまい具合に、$ A $、$ B $の間でやり取りされる内部エネルギーは保存するので、

<tex>
\delta U_a \ +\ \delta U_b \ =\ 0 
</tex>

という拘束条件がついており、これを使えば、

<tex>
\delta S\ =\ \left( \frac{1}{T_a} - \frac{1}{T_b} \right) \delta U_a 
</tex>

のように非常に簡単な形にまとめられる。
　そしてこれが$ U_a $の変化に対して 0 であるためには

<tex>
T_a = T_b
</tex>

が成り立っていればいい事が分かるのである。

<P>

　つまり$ A $、$ B $の温度が等しくなるところが安定な状態だと言っているわけで、
自然に熱平衡に落ち着くことを表しているのだ。
　しかしこれを見て「熱力学の第 0 法則」は不要だったなどと考えてはいけない。
　ここまでの議論は第 0 法則を前提にして導かれてきたわけで、
ここはそれに反する結果が出なくて良かったと胸を撫で下ろすべき場面である。

<P>

　さて、もう一つの条件「これは本当に極大点なのか」ということを確かめておこう。
　この例題では体積が変化しないので、1 変数の関数と変わらない。
　それで普通に 2 階微分を計算してやればいい。

<tex>
\delta^2 S\ &=\ \frac{1}{2} \left[ \pddif{S_a}{U_a}(\delta U_a)^2 \ +\ \pddif{S_b}{U_b}(\delta U_b)^2 \right] \\
&=\ \frac{1}{2} \left[ \pdif{{\frac{1}{T_a}}}{U_a} (\delta U_a)^2 \ +\ \pdif{{\frac{1}{T_b}}}{U_b} (\delta U_b)^2 \right] \\
&=\ \frac{1}{2} \left[ -\frac{1}{T_a^2} \thdif{T_a}{U_a}{V_a} \!\!\! (\delta U_a)^2 \ -\ \frac{1}{T_b^2} \thdif{T_b}{U_b}{V_b} \!\!\! (\delta U_b)^2 \right] \\
&=\ \frac{1}{2} \left[ -\frac{1}{T_a^2} \frac{1}{n C_{V_a}} (\delta U_a)^2 \ -\ \frac{1}{T_b^2} \frac{1}{nC_{V_b}} (\delta U_b)^2 \right] 
</tex>

　$ S $が極大になる条件はこの各項の係数が負になることである。
　温度$ T $やモル数$ n $などは当然正値であるので特に考える必要もないが、
定積比熱$ C_V $の正負についてはまだこれまで考えたことがなかった。
　つまり、

<tex>
C_{V_a} > 0\ \ ,\ \ C_{V_b} > 0 
</tex>

が平衡の条件だということが言える。

<P>

　さて、これを根拠にして$ C_V $は必ず正でなければならないことが
あたかも証明されたかのように書いてある教科書があるが、誤解せぬよう注意して読むようにしよう。
　もし$ C_V $が負になっている場合があれば、その時には安定しないと言っているだけだ。

<P>

　もし$ C_V $が負であると、熱が流入するほど温度が下がることになる。
　逆に熱が逃げるほど温度が上がる。
　そんなバカな、と思う人はこんな議論はしないで$ C_V $が正であることを
根拠もなく疑いもせずに信じていればいい。
　しかしそういうことだってあるかも知れないではないか。
　$ C_V $が常に負だというのでは経験に反するので、
仮に、ある限られた狭い温度範囲でだけ$ C_V $が負になるような物質があったらどうなるかを考えてみよう。

<P>

　二つの部分が完全に同じ温度になって接しているとする。
　これらの間に少しでも熱のやりとりがあれば、
熱を受けた側は温度が下がり、そのためにますます熱が流れ込み、
熱を失った側はますます温度が高くなり、そのために熱の流出は止まらないだろう。
　確かにこれは不安定である。
　しかしこの状態は長くは続かない。

<P>

　ある程度以上に温度が変化してしまうとやがて$ C_V $が正に転じるところに来る。
　それでもしばらくは温度差があるので、熱の流れは止まらない。
　しかし、さらに熱が流れたところで温度は元に戻り、両者の温度が同じになるところがきっとある。
　そこが安定点だ。
　先ほどの計算結果は「温度が等しく、定積比熱が正のところで安定する」
と言っているだけであり、このようなちょっと不思議な状況を仮定しても確かに矛盾は無い。

<P>

　問題は、果たしてこんな現象が実際にあるのだろうか、ということだが、
今回の計算結果はそれについては何も教えてくれてはいないのだ。
　教科書を鵜呑みにするのは恐い。

<P>

　いや、ちょっと待て。
　もし温度が等しくても不安定になるような状態があるとしたら、
そこでは熱平衡が起こらないので、その時の温度そのものが定義できないのではないだろうか？
　温度という状態量は第 0 法則で熱平衡を頼りに規定したのだった。
　第 0 法則のやり方では抜け穴があるのだろうか？
　それとも現実には$ C_V $は必ず正であってこういうことを考える必要はないのだろうか。

<P>

　この問題は保留にしておく。
　我々はこの段階では温度の正体も内部エネルギーの正体も知らないことになっているのだ。

\note{<B>追記</B>(2023/12)：　定積比熱が負になる話は私はいまだ知らない。
比熱が負になる例ならば、恒星のように自己の重力で収縮している場合に在り得る。
これは熱エネルギーを失うと収縮が起こってかえって温度が上がるというものである。
しかしこのような場合には体積が変化しているので定積比熱が負であるというわけではない。}

% ===================================================================

\section{ルシャトリエの原理}

　先ほどの例は計算に慣れるという意味では簡単過ぎだった。
　もう一つ例題をやっておこう。

<P>

　先ほどと同じ断熱シリンダーを考える。
　一つだけ大きな違いは、
二つの部分を仕切っている壁が自由に動くことである。

<P>

　$ \delta V $が 0 ではないので先ほどのように 1 変数の関数としては扱えない。
　計算は複雑になる。
　ささやかな助けとして次の 2 つの拘束条件が与えられている。

<tex>
\delta U_a + \delta U_b \ &=\ 0 \\[3pt]
\delta V_a + \delta V_b \ &=\ 0 
</tex>

　まずは 1 次の変分から。
　一気に計算しよう。

<tex>
\delta S\ &=\ \thdif{S_a}{U_a}{V_a} \!\!\! \delta U_a + \thdif{S_a}{V_a}{U_a} \!\!\! \delta V_a
            + \thdif{S_b}{U_b}{V_b} \!\!\! \delta U_b + \thdif{S_b}{V_b}{U_b} \!\!\! \delta V_b \\
&= \frac{1}{T_a} \delta U_a + \frac{p_a}{T_a} \delta V_a
  + \frac{1}{T_b} \delta U_b + \frac{p_b}{T_b} \delta V_b \\
&= \left( \frac{1}{T_a} - \frac{1}{T_b} \right) \delta U_a
 + \left( \frac{p_a}{T_a} - \frac{p_b}{T_b} \right) \delta V_a 
</tex>

　これが 0 になるための条件は、

<tex>
T_a &= T_b \\
p_a &= p_b 
</tex>

である事が分かる。
　つまり、温度だけでなく、同時に圧力も同じ値になるところで安定するということだ。
　当たり前だ。
　もし圧力が同じでなかったら壁は動くだろうから状態は変わってしまう。
　そんなところが安定であるはずがない。
　しかしその当たり前の事がエントロピーの性質だけから導けてしまうところが面白いのだ。

<P>

　次に 2 次の変分を求めてみよう。
　大抵の教科書では面倒な極値判定を避けるために
スマートな変形方法を使うところだが、
そういう事情を知らない読者は何か誤魔化された気分になるものだ。
　ここではトリックなしにバカ丁寧に真正面からぶつかることにする。
　総員、ショックに備えよ！

\note{　ここでやけにテンションが高いのは修正前の名残である。
途中で説明を挟むことなく、長いごちゃごちゃした計算式を一気に書き下していた。
計算の方針に不備があったために短く区切って説明することになったのでそれほどショックな見た目ではなくなってしまった。（記事末尾の修正履歴を参照）}

<tex>
\delta^2 S\ &=\ \frac{1}{2} \left( \pddif{S_a}{U_a}\delta U_a^2 + \henbun{S_a}{U_a}{V_a} + \henbun{S_a}{V_a}{U_a} + \pddif{S_a}{V_a}\delta V_a^2 \right. \\
&\ \ \ \ \ \ \ \ \ \left. + \pddif{S_b}{U_b}\delta U_b^2 + \henbun{S_b}{U_b}{V_b} + \henbun{S_b}{V_b}{U_b} + \pddif{S_b}{V_b}\delta V_b^2 \right) \\
&=\ \frac{1}{2} \left( \pddif{S_a}{U_a}\delta U_a^2 + 2 \henbun{S_a}{U_a}{V_a} + \pddif{S_a}{V_a}\delta V_a^2 \right. \\
&\ \ \ \ \ \ \ \ \ \left. + \pddif{S_b}{U_b}\delta U_b^2 + 2 \henbun{S_b}{U_b}{V_b} + \pddif{S_b}{V_b}\delta V_b^2 \right) 
</tex>

　とりあえずここまでにして式を眺めてみよう。
A 区画に関する式と B 区画に関する式に分かれているが、これらをまとめられるかどうかを考えてみる。
どちらの区画にも同じ気体が入っているので偏微分の振る舞いは同じだろう。
先ほど求めた$ T_a = T_b $や$ p_a = p_b $という条件が満たされている付近での振る舞いを調べようとしているのだから値も同じになると考えて問題なさそうだ。
さらに拘束条件から$ \delta U_a = - \delta U_b $や$ \delta V_a = - \delta V_b $が言えるのだが、
これらを代入してみると 2 乗などによって各項の符号の違いも消えてしまう。
それで、わざわざ A 区画と B 区画の変数を区別する必要もなくなり、全体を次のように表すことが出来るだろう。

<tex>
\delta^2 S\ =\ \pddif{S}{U} \delta U^2 + 2 \henbun{S}{U}{V} + \pddif{S}{V} \delta V^2
</tex>

　これを使ってもう少し計算を進めてみる。

<tex>
\delta^2 S \ &=\ \pdif{\frac{1}{T}}{U}\delta U^2 + 2 \pdif{\frac{1}{T}}{V} \delta U \delta V + \pdif{\frac{p}{T}}{V}\delta V^2 \\[3pt]
&=\ -\frac{1}{T^2} \pdif{T}{U} \delta U^2 - \frac{2}{T^2} \pdif{T}{V} \delta U \delta V + \left( \frac{1}{T} \pdif{p}{V} - \frac{p}{T^2} \pdif{T}{V} \right) \delta V^2 \\[3pt]
&=\ - \frac{1}{T^2} \left( \pdif{T}{U} \delta U^2 + 2 \pdif{T}{V} \delta U \delta V + \left[ p \pdif{T}{V} - T \pdif{p}{V} \right] \delta V^2 \right)
</tex>

　安定のためにはエントロピー$ S $が極大になっていてほしいのであり、
この式が$ \delta U $、$ \delta V $のどんな変化に対しても負になるための条件を調べればよい。
ヘッセ行列は次のようになる。

<tex>
- \frac{1}{T^2}
\left( \begin{array}{cc}
\displaystyle \pdif{T}{U} & \displaystyle \pdif{T}{V} \\[12pt]
\displaystyle \pdif{T}{V} & \displaystyle \left[ p \pdif{T}{V} - T \pdif{p}{V} \right] \\[12pt]
\end{array} \right)
</tex>

　分かり易く書くために共通部分をカッコの外に出してあるが、すべての成分にこれが掛かっていると考えてもらいたい。
左上の成分が負であるという条件が欲しいので、まず

<tex>
\thdif{T}{U}{V} \ >\ 0 \tag{1}
</tex>

が言えることが必要になる。
　ここで急に偏微分の固定変数をちゃんと書くようにしたが、あまり式の見た目がごちゃごちゃしないために略していたのである。
今回は$ S(U,V) $という形の関数だと考えて計算してきたので、
ここまでのところは$ U $で偏微分してあれば$ V $が固定されているし、$ V $で偏微分してあれば$ U $が固定されているとすぐに判断が付く。
この後の計算ではその辺りをちゃんと意識した計算が必要になってくるので、ここからはちゃんと書くようにしよう。

<P>

　次に行列式の値が正であるという条件を確認するが、
正負さえ分かればいいので、括弧の外に出した部分は省略して計算しよう。
読者は誤解せぬよう、ここで行列式の性質をしっかり確認して、私がどんなずるいことをしたかを理解しておくべきである。
ある一つの行だけに定数を掛けると、行列式はその定数倍になる。
今は 2 つの行に定数を掛けていることになるので、カッコの外の定数の 2 乗を掛けたものが本来の行列式である。
それは$ 1/T^4 $であり、必ず正になるので略す。
先ほど書いた行列の中の 4 つの成分だけを使って行列式を計算してみよう。

<tex>
D\ &=\ \thdif{T}{U}{V} \, \left[ p \thdif{T}{V}{U} - T \thdif{p}{V}{U} \right] - \thdif{T}{V}{U} ^{\!\!\!2} \\[3pt]
&=\ p \thdif{T}{U}{V} \thdif{T}{V}{U} - T \thdif{T}{U}{V} \thdif{p}{V}{U} - \thdif{T}{V}{U}^{\!\!\!2} \tag{2}
</tex>

　続きを計算しようとしたが、こんな早い段階でもう行き詰まってしまう。
元々、なぜ教科書ではわざわざ奇妙な方法で計算しているのだろうかという疑問から始まって、
もっと素直に計算して同じことは出来ないのだろうかと考えてここまでやってみたわけだが、こういう落とし穴があったわけだ。

\note{　修正前の記事では、偏微分の固定変数を無視したデタラメな式変形で教科書と同じ結論に無理やり持って行ったのである。
書いた当時は偏微分をまだあまり理解しておらず、固定変数の違いを軽視していたのであった。}

　そういうわけで、ここから先は、教科書に書いてある結論を知っているという前提で、
そこに到達するための式変形の正しい手順を何とかひねり出すという感じの話になる。
試行錯誤でやってみたので、自然に思い付くのは難しいかと思う。

<P>

　そもそも$ U $を固定変数にしたような物理量というのはあまり見かけない。
例えば第 2 項に出てきている$ \ (\pdifline{p}{V})_U $の固定変数が$ U $の代わりに$ T $だったりした方が馴染みがあるというか、そういう形のものを見かけた気がする。
固定変数だけを変更するような計算テクニックはこれまでには出てこなかったので、ここで紹介しておこう。
今出てきている$ p $などは$ S(U,V) $を微分することで出てきたものなので、具体的に計算するとなると$ p(U,V) $という形で表されて出てくるはずである。
ところがこの$ p $は実は$ p(T,V) $という形の関数であると考えてみる。
どうやって辻褄を合わせるかというと、この$ T $が$ T(U,V) $という形の関数だと考えるのである。
すると$ p $は$ p(T(U,V),V) $という形になっており、$ p $は表向きは$ p(U,V) $であるようにも見えるというわけだ。

<tex>
p(U,V) \ =\ p\Big( T(U,V), V \Big)
</tex>

　このような$ p $を、$ U $を固定して$ V $で微分してやると、$ p $の中の$ T $を微分してその$ T $の中に含まれる$ V $を微分するという合成関数の微分と、
$ p $の中に直接含まれる$ V $を微分することが必要になるので、次のようになる。

<tex>
\thdif{p}{V}{U} \ =\ \thdif{p}{T}{V} \thdif{T}{V}{U} \ +\ \thdif{p}{V}{T} \tag{3}
</tex>

　ややこしくはなったが、右辺の第 2 項と左辺を比べてやると、固定変数だけを変更することに成功していることが分かる。
この (3) 式を (2) 式に代入して整理してみよう。

<tex>
D\ &=\ p \thdif{T}{U}{V} \thdif{T}{V}{U} \\
&\hspace{30pt} - T \thdif{T}{U}{V} \left[ \thdif{p}{T}{V} \thdif{T}{V}{U} \ +\ \thdif{p}{V}{T} \right] \\
&\hspace{30pt} - \thdif{T}{V}{U}^{\!\!\!2} \\[8pt]
&=\ p \thdif{T}{U}{V} \thdif{T}{V}{U} \ - T \thdif{T}{U}{V} \thdif{p}{T}{V} \thdif{T}{V}{U} \\
&\hspace{30pt} - T \thdif{T}{U}{V} \thdif{p}{V}{T} \ - \thdif{T}{V}{U}^{\!\!\!2} \\[8pt]
&=\ \thdif{T}{U}{V} \thdif{T}{V}{U} \left[ \ p \ - T \thdif{p}{T}{V} \right] \\
&\hspace{30pt} - T \thdif{T}{U}{V} \thdif{p}{V}{T} \ - \thdif{T}{V}{U}^{\!\!\!2} \tag{4}
</tex>

　さて、<a href="./joule.html">少し前の記事</a>で「\black{エネルギー方程式}」というものが出てきたのを覚えているだろうか。
次のような式である。

<tex>
\thdif{U}{V}{T} \ =\ T \thdif{p}{T}{V} \ -\ p
</tex>

　(4) 式にはこれを当てはめることの出来る形が生まれている。
続きをやってみよう。

<tex>
D\ &=\ -\thdif{T}{U}{V} \thdif{T}{V}{U} \thdif{U}{V}{T} \\
&\hspace{30pt} - T \thdif{T}{U}{V} \thdif{p}{V}{T} \ - \thdif{T}{V}{U}^{\!\!\!2} \\[8pt]
&=\ -\thdif{T}{V}{U} \left[ \thdif{T}{U}{V} \thdif{U}{V}{T} \right] \\
&\hspace{30pt} - T \thdif{T}{U}{V} \thdif{p}{V}{T} \ - \thdif{T}{V}{U}^{\!\!\!2} \\[8pt]
&=\ -\thdif{T}{V}{U} \left[ -\thdif{T}{V}{U} \right] \\
&\hspace{30pt} - T \thdif{T}{U}{V} \thdif{p}{V}{T} \ - \thdif{T}{V}{U}^{\!\!\!2} 
</tex>

　ここで使ったのは<a href="./state_eq.html">最初の方の記事</a>で説明した「\black{マクスウェルの規則}」である。
偏微分どうしをいかにも割り算のように見て計算をしているようだが、マイナスが余計に付いてくるというものである。
ここまで来れば、あと一息だ。

<tex>
D \ &=\ \thdif{T}{V}{U}^{\!\!\!2} - T \thdif{T}{U}{V} \thdif{p}{V}{T} - \thdif{T}{V}{U}^{\!\!\!2} \\[8pt]
&=\ - T \thdif{T}{U}{V} \thdif{p}{V}{T}
</tex>

　やっと終わった。
これが正の値であってほしいので、(1) 式の条件も考慮に入れると、次のような条件が成り立っていてほしい。

<tex>
\thdif{p}{V}{T} \ < \ 0 \tag{5}
</tex>

　こうして得た (1) 式と (5) 式の物理的な意味は何だろうか？
実は「定積モル比熱」$ C_V $や「等温圧縮率」$ \kappa $という形で紹介済みである。
これらは次のように定義されていたのだった。

<tex>
C_V\ &=\ \frac{1}{n} \thdif{U}{T}{V} \\[3pt]
\kappa\ &=\ - \frac{1}{V} \thdif{V}{p}{T}
</tex>

　つまり、次のような条件が満たされていれば安定だと言えそうである。

<tex>
C_V \ > \ 0 \\[3pt]
\kappa \ > \ 0
</tex>

　つまりこの場合の安定条件は、
先ほども求めたように定積比熱が正であるということと、
さらに等温圧縮率$ \kappa $が正であるということである。
　もし$ \kappa $が負ならば、体積が増えるほど圧力が強まるわけで、
一度外部の圧力に勝って体積が増える事があればその後はどこまでも勢い良く膨張を続けるだろう。
　あるいは体積が減るほど圧力が減少するので、
一度外圧に負ければあっという間にぺしゃんこになってしまうことも起こり得る。
　これでは当然、安定であるはずがない。
　しかしそういう状態が一瞬たりとも有り得ないかというと、
それについてはこの結果からは何も言えないのだ。

\note{　先ほどはA区画とB区画とで内部の気体の種類は同じだと仮定して式を一つにまとめたのだが、
この結論を見るとそのような仮定は必要なかったようである。
それぞれの区画について同じ形の式が成り立っているので別々に計算してもそれぞれに同様な結論に達するし、
それらは両立するようなものだからである。}

　ここで求めた事は「\red{ルシャトリエの原理}」と呼ばれるものの一部である。
　高校の化学でもお世話になっただろう。
　「系が何らかの原因で平衡状態から外れると、
その原因を取り除く方向へ変化が進む」というものである。
　圧力差、温度差があると、それを取り除く方向へ変化が進む。
　そもそも安定平衡というのはそういうものだ、それでなければ安定では有り得ない、と考えれば、
ごく当たり前のことを言っているに過ぎないのだが。

<P>

　ルシャトリエの原理というのは化学平衡についても成り立つのだった。
　むしろそちらの目的で使うことの方が遥かに多い。
　化学平衡は今回の平衡の話とはあまり関係ないのではないかと感じるかも知れないが、実は同じことである。
　化学変化というものも一方にだけ進むものではない。
　物が燃えるのも、還元反応が起こるのも、
ただただ、その時々の環境によって決まる平衡状態へ向けての電子の移動に過ぎないのだ。
　物が燃えて灰になるのはその方がエネルギーを放出できて安定だからだという考えは、
放出した方が安定であるような環境でだけ言える狭い常識に過ぎない。
　自然はエネルギーが低い方が安定だなどとは考えていないのである。


% ======================================================================

\section{本質は何か}

　おしゃべりが長くなってしまったがもう少しだけ話させて欲しい。
　今回やったことを振り返るに、
温度や圧力の釣り合いの話に過ぎなくて、
わざわざエントロピーなどという数学的な何かを
導入しなくても説明できてしまうことであった。

<P>

　エントロピーは抽象的概念に過ぎず、
現実に起きているのは、圧力による壁の押し合いへし合いである。
　エントロピーはそれらの現象をまとめるためにうまく導き出された人為的な量である。
　……と、具体的イメージを大切にするいつもの私ならそう言うだろう。

<P>

　しかし、やがて統計力学を学べばこの辺りの考えが逆転する。
エントロピーには驚くほど具体的なイメージがあり、
そちらの方こそが現象の本質に近い。
逆に、温度や圧力の方がエントロピーを基にして説明されることになる。

<P>

　統計力学の世界観を身に付けると、
全ての現象が確率の結果に過ぎないと思えるようになる。
粒子のバラバラに見える移動の結果を統計的に調べてやると、
全体としての動きが一つのまとまった現象を起こしているように見えるわけだ。

<P>

　果たして、この世の全ては確率で決まるものなのだろうか？

% ======================================================================

\section{次回予告}

　今回は計算に慣れることに集中したため、$ F $や$ G $が極小になる場合についての
例題を行う余裕がなかった。
　これらは次回に行うことにしよう。
　例題とは言っても、おまけ程度の議論などではなく、
熱力学の中心的な部分を真っ直ぐに突っ走っているのだから読み飛ばすべきではない。

<P>

　ここまではずっと気体のみを考えてきたが、
とうとう液体についても考えを広げることになる。
　今回よりも面白くなるだろう。


% ===========================================================

\section{修正履歴}

(2023/12/07)<br>
\　・比熱が負になる例について追記した。<br>
\　・2行2列のヘッセ行列について括弧書きで「（この時、行列式が正なので当然右下も正であるが）」と書いていた部分が意味不明なので削除した。<br>
\　・最初の例での2次の変分の計算中において(1/T)をUで偏微分したときのマイナス符号が抜けていたので修正した。<br>
\　・「ルシャトリエの原理」の節での計算に幾つもの間違いがあったので修正した。<br>
\　具体的には……<br>
\　・「A区画とB区画は同じ形の式になっているので一方を計算すれば十分だろう」と言って拘束条件について考慮に入れず、代表として A 区画のみを計算していた。
結果は変わらないが、方針は正しくなかった。<br>
\　・ヘッセ行列の行列式を計算するところの偏微分の式変形がデタラメであった。固定変数を無視して本来成り立たない計算を書いていた。

