\field{電子回路}
\title{インピーダンス}
\comment{計算がややこしいだけで意味は簡単。}
\prev{reactance}
\next{pfactor}
\create{2015/6/24}
\modify{}


\section{インピーダンスの意味}

　次はコイルやコンデンサーや抵抗を「組み合わせた」回路について考えてみよう。

<P>

　コイルやコンデンサーを通った電流は、位相が進んだり遅れたりするのだった。
　しかしそれは電流が個々の部品を通過するたびにずれていって、
どんどんとずれ方が蓄積されて大きくなるというわけではない。
　回路のどの場所を見てもつじつまが合うような電流が、回路全体でしっかり調整された形で流れるのである。

<P>

　例えば、複雑な回路であったとしても、
「ある一つのコイルを流れる電流」と「そのコイルの両端の電圧」を見れば、
前回話したような関係は依然として成り立っている。
　また、コンデンサについても同じことが言える。

<P>

　抵抗もそうだ。
　抵抗の場合は電流と電圧にずれは生じないのだった。
　だから、抵抗を流れる電流とその両端の電圧だけを見れば、
それは普通にオームの法則が成り立つ形になっている。

<P>

　もう少し詳しく話そう。
　抵抗とコイルとコンデンサーを直列にして交流を流した場合、
この 3 つの部品にはどれも同じ大きさの電流が同じタイミングで流れる。
　一本の線なのだから当然である。
　それぞれの電流に位相のずれはない。

<P>

　ところがそれぞれの部品の両端の電圧はそれぞれがずれている。
　抵抗の両端の電圧には電流との位相のずれはないし、
コンデンサーの両端の電圧は電流より 1/4 周期だけ遅れているし、
コイルの両端の電圧は電流より 1/4 周期だけ進んでいる。

<P>

　さて、この回路全体の電圧を知りたければ、
この 3 つの部品の両端の電圧を全て足し合わせることになるわけだが、
その結果はどんなものであろうか？

<P>

　数学に詳しい人なら、これはひどく複雑な波形になるわけではないことを知っているだろう。
　足し合わせる波形の周波数がどれも同じである限り、周波数がもとと変わらない単純なサイン波になる。
　ただし、位相は足し合わせる前の電圧のどれともずれた形になっている。
　このことを単純に示す公式は高校で習う数学の範囲には見当たらないが、
ちょっと手間を惜しまなければ説明は可能である。
　3 つの波の足し算は面倒だから、
とりあえず、2 つの、振幅と位相の異なる波の足し算をやってみよう。

<P>

　二つの波はそれぞれ、三角関数の合成の公式を逆に使って次のように分解して表記できる。

<tex>
A \sin(\theta + \delta\,) \ &=\ A' \sin \theta \ +\ A'' \cos \theta \\
B \sin(\theta + \delta') \ &=\ B' \sin \theta \ +\ B'' \cos \theta
</tex>

　これらの和を取ってから、今度は三角関数の合成の公式を普通に使えば次のような変形ができる。

<tex>
A \sin(\theta + \delta) \ +\ B \sin(\theta + \delta') \ &=\ (A'+B') \sin \theta \ +\ (A''+B'') \cos \theta \\
&=\ C \sin (\theta + \delta'')
</tex>

　この$ \theta $の部分を$ 2\pi f t $に置き換えて考えれば、今回の話と同じだ。
　周波数が同じで位相や振幅の異なる波を幾つ足し合わせても、位相が変わるだけで、
周波数や波形は変わらないということが分かるだろう。

<P>

　位相がどれくらい変わるかというと、足し合わせる個々の波形のうち、
振幅の大きかった方の位相により近くなるのである。

<P>


　もう一つの例を話しておこう。
　今度はそれぞれの部品を並列にした場合で、どの部品にも同じ交流電圧が掛かる。
　しかしそれぞれに流れる電流は違っていて、振幅も位相も異なるのである。
　ただ、周波数だけはどれも同じだ。
　この回路全体に流れ込む電流はどうなっているかというと、
3 つそれぞれの電流を足せばいいのである。

<P>

　これも、先ほど説明したばかりの理屈によって、
周波数が元と同じで、位相がずれただけの交流電流が導かれてくることが分かる。

<P>

　このような具合であるから、
抵抗やコイルやコンデンサーを複雑に組み合わせたものを一つの集まりとして外から見ると、
「そこを流れた全電流」と「その全体に掛かっている電圧」は 1/4 周期だけどちらかへずれるのではなく、
単純には計算出来ないようなずれ方をするのである。
　もちろん、先ほどのように三角関数の合成の公式を駆使すれば、どれだけずれるかはちゃんと計算できるはずである。

<P>

　そのときの電流と電圧の最大値も計算できるので、それらの比を考えれば、
ここでも抵抗に似た概念が導き出せるだろう。
　これを「\red{インピーダンス}」と呼ぶ。

<P>

　インピーダンスとは、抵抗（レジスタンス）やリアクタンスを合成したものであり、
交流の流れにくさを表す概念だと言えるだろう。
　この単位もやはり Ω（オーム）である。


% =======================================================================

\section{複素数の助けを借りる}


　先ほど、インピーダンスを計算するには、
三角関数の合成の公式を駆使して、ややこしい計算をする必要があるような説明をした。
　しかし、複素数の助けを借りることで、もっと少ない手間で、
そして、図形的イメージで、インピーダンスの大きさどころか、
位相のずれの具合まで簡単に計算できてしまうのである。

<P>

　そのためには複素数について少々学ぶ必要があるが、
習うより慣れろ、というやつで、
その意味をあまり理解していなくても計算だけは一定の手続きで出来てしまう。
　微分や複素数を知らない小学生でも覚えることができる。
　その方法だけ教えてほしいという人もいるだろうが、
ちゃんと理解できていれば感動して楽しくなれるので、なんとか説明してみよう。

<P>

　しかしここで複素数について一から話し始めるわけにも行かないので、
付いてこれなくなった人は「<a href="../math/chap_imaginary.html">複素関数論</a>」を学んでみてほしい。
　最初の 3 つほどの記事を読むだけで十分であるが、必要以上のことにまで触れているので、
そちらを読む方が難しいかも知れない。

<P>

　まず、次のような「オイラーの公式」というものが前提である。

<tex>
e^{j\theta} \ =\ \cos \theta \ +\ j \,\sin \theta \tag{1}
</tex>

　$ j $は虚数単位であり、2 乗して -1 になるような数である。
　数学では$ i $を使うが、電子工学では$ i $は電流を意味することが多いので、
虚数に$ j $を使うのが普通なのである。

<P>

　今までは交流電圧や交流電流を表すのに主に$ \sin $関数を使って来たわけだが、
これは別に$ \cos $関数を使っても構わなかったのである。
　単なる好みの問題であった。
　例えば電流を

<tex>
I \ =\ A \, \cos ( 2\pi f t \ +\ \delta ) \tag{2}
</tex>

と表してもいいわけである。
　ところが、今、ちょっと思い切って、電流を

<tex>
I \ =\ A \, e^{j(2\pi f t \ +\ \delta)} \tag{3}
</tex>

と表してみることにしよう。
　ちょっとこれは思い切りが良すぎる気がする。
　先ほどのオイラーの公式によれば、これは、

<tex>
I \ &=\ A \, \Big[ \cos( 2\pi f t + \delta ) \ +\ j \, \sin( 2\pi f t + \delta ) \Big] \\
&=\ A \, \cos \big( 2\pi f t + \delta \big) \ +\ j \, A\, \sin \big( 2\pi f t + \delta \big) 
</tex>

と書いているに等しいわけで、第 1 項の実数部分は確かに (2) 式に等しいけれども、
第 2 項の虚数部分は全く余計であって、付けておく意味が分からないからである。
　実はこの虚数部分は全く気にしなくて構わないのである。
　(3) 式のように表現することで、微分計算が楽に済むという利点を拝借したいだけであり、
実数部分にのみ着目していれば問題ない。

<P>

　本題に入る前に、まずその辺りをもう少し説明しておこう。
　(3) 式を時間で微分したらどうなるだろうか。

<tex>
\dif{I}{t} \ =\ 2\pi f j \, e^{j(2\pi f t \ +\ \delta)}
</tex>

　指数関数の微分というのはとても簡単で、もとの関数部分は変化せず、
その肩に乗っている部分を微分して掛ければいいだけである。
　確認のため、この結果をオイラーの公式を使って三角関数を使った形に戻してみよう。

<tex>
\dif{I}{t} \ &=\ 2\pi f j \, A \, e^{j(2\pi f t \ +\ \delta)} \\
&=\ 2\pi f j \, A \, \Big[ \cos\big( 2\pi f t + \delta \big) \ +\ j \, \sin \big( 2\pi f t + \delta \big) \Big] \\
&=\ 2\pi f j \, A \, \cos \big( 2\pi f t + \delta \big) \ -\ 2\pi f\, A \, \sin \big( 2\pi f t + \delta \big) 
</tex>

　第 1 項が虚数になり、第 2 項が実数になった。
　実数の方だけを見ていれば、(2) 式を微分したのと結果が変わらないのである。
　虚数部分は完全に無視して構わない。

<P>

　ところで先ほどから、$ 2\pi f $という形ばかりが出てきて、非常にごちゃごちゃしてしまっている。
　交流の話では$ 2 \pi f $というのはいつもひとまとまりで出てくるので、
式を簡略化するために、次のような記号を導入しよう。

<tex>
\omega \ \equiv \ 2\pi f
</tex>

　この$ \omega $のことを「\red{角周波数}」と呼ぶ。
　物理では「角振動数」と呼ぶが、電子工学の話をしているのでその流儀で行こう。
　三角関数の位相は$ 2\pi $で一周して元に戻るので、
$ \omega $というのは 1 秒間に位相がどれだけ進むかを表したものだと考えればいい。
　わざわざ無理してイメージを描かなくても、単なる$ 2\pi f $の略記号だと思っておいても本当に問題ない。

<P>

　これを使うと今まで書いたものは本当にすっきりする。
　電流は

<tex>
I \ =\ A \, \cos( \omega t \ +\ \delta)
</tex>

と表してもいいし、

<tex>
I \ &=\ A \, e^{j(\omega t \ +\ \delta)} \\
&=\ A \, e^{j\omega t} \, e^{j \delta} \tag{4}
</tex>

と表してもいい。
　この微分は

<tex>
\dif{I}{t} \ =\ j\omega A \, e^{j\omega t} \, e^{j \delta}
</tex>

と表してもいい。
　微分するという作業が、単に、$ j\omega $を掛けるという作業に置き換わっているのである。


% =======================================================================

\section{抵抗とコイルの直列}

　試しに、抵抗$ R $とコイル$ L $を直列につないだものを考えてみよう。
　直列で一本の線なのだから、どちらに流れる電流も同じである。
　この時、両方の電圧の合計を計算してみよう。
　キルヒホッフの法則（一周すると電圧は 0 になること）より、

<tex>
V \ -\ R\, I \ -\ L \dif{I}{t} \ =\ 0
</tex>

が成り立っており、移項すると

<tex>
V \ &=\ R\, I \ +\ L \dif{I}{t}
</tex>

である。
　ここで、電流を (4) 式で表すことにすると、

<tex>
V \ &=\ R\, I \ +\ L \dif{I}{t} \\
&=\ R \, A\, e^{j\omega}\, e^{j\delta} \ + \ L (j\omega) A\, e^{j\omega}\, e^{j\delta} \\
&=\ ( R \ +\ j\omega L ) \, A\, e^{j\omega}\, e^{j\delta} \\
&=\ ( R \ +\ j\omega L ) \, I
</tex>

のような関係になっていることが分かる。
　交流電圧$ V $と交流電流$ I $とを比べてみれば、$ ( R \ +\ j\omega L ) $の部分が抵抗に相当する量を表している。
　これをインピーダンスと呼ぶのであった。
　しかしここには虚数$ j $が含まれており、実数ではない。
　これは複素数だ。
　それでこれを「\red{複素インピーダンス}」と呼ぶのである。
　複素インピーダンスは$ Z $という記号で表し、単位はやはり Ω（オーム）である。

<tex>
Z \ =\ R \ +\ j\omega L
</tex>

　この意味を解釈してやらなければならない。
　この複素数$ Z $は、複素平面上に表せば、次のようである。

\image{./impedance/impedance1.png,誘導性リアクタンスと抵抗との合成インピーダンスを複素平面上に表した図}

　抵抗$ R $と、コイルのリアクタンス$ X_L = \omega L $が作る合成ベクトルのような位置にある。

<P>

　ところで、複素数どうしの掛け算をするときにはとても簡単な図形的ルールが成り立っている。
　まず、それぞれの複素数を複素平面上に表して、それぞれに原点から矢印を引き、その矢印の長さと、
実軸（横軸）からの角度を求める。
　その矢印の長さを「絶対値」と呼び、その角度のことを「偏角」と呼ぶ。
　そして、それぞれの絶対値どうしを掛けあわせ、それぞれの偏角どうしを足し合わせる。
　そうして得られた絶対値の積と、偏角の和が、それぞれ、結果の複素数の絶対値と偏角を意味している。
　このようにして結果の値が複素平面上のどこにあるかが図形的に分かるのである。

<P>

　つまり、今回の場合、

<tex>
V \ =\ Z\, I
</tex>

であり、$ Z $と$ I $という二つの複素数を掛け合わせて複素数で表された電圧$ V $を求めているのだから、
電流の最大振幅$ A $にこの$ Z $の矢印の長さを掛けたものが電圧の振幅になり、
この$ Z $の矢印が向いている角度$ \theta $分だけ電流の位相を進ませたものが、電圧の位相になるということだ。

<P>

　コイルのみの場合には電圧の位相は電流より 1/4 周期進むのだが、
抵抗$ R $が存在しているせいで、全体としてはそれほどは進んでいないように見えるのである。


% =======================================================================

\section{抵抗とコンデンサの直列}

　では抵抗とコンデンサの直列を考えてみよう。
　先ほどのようにやると少し面倒なので、コンデンサの両端の電圧と電流の関係を先に求めておこう。

　コンデンサは$ Q = CV $の関係になっており、この両辺を時間で微分することで、

<tex>
I \ =\ C \dif{V}{t}
</tex>

が得られるのだった。
　ここでコンデンサーの両端の電圧を$ V_c = A e^{j\omega t} e^{j\delta} $だと仮定すると、

<tex>
I \ &=\ j \omega C \, A \, e^{j\omega t} e^{j\delta} \\
&=\ j \omega C \, V_c
</tex>

という関係が得られる。
　これを変形すれば、

<tex>
V_c \ =\ \frac{1}{j \omega C} \, I
</tex>

という関係であることが言える。

<P>

　ここからがやっと本題だ。
　抵抗とコンデンサを直列にした時の合計の電圧は、

<tex>
V \ &=\ R\,I \ +\ \frac{1}{j \omega C} \, I \\
&=\ \left( R \ +\ \frac{1}{j \omega C} \right) \, I
</tex>

であって、このたびの複素インピーダンスは次のように表せる。

<tex>
Z \ =\ R \ +\ \frac{1}{j \omega C}
</tex>

　$ 1/j = -j $だから次のように書いてもいい。

<tex>
Z \ =\ R \ -\ j \, \frac{1}{\omega C}
</tex>

　これを複素平面上に図示すると、次のようになる。

\image{./impedance/impedance2.png,容量性リアクタンスと抵抗との合成インピーダンスを複素平面上に表した図}

　コンデンサのリアクタンス$ X_C = 1/(\omega C) $は虚数軸の負の方向のベクトルで表され、
それと抵抗$ R $が作る合成ベクトルのような位置に$ Z $がある。


% =======================================================================

\section{RLC直列インピーダンス}

　では、抵抗とコイルとコンデンサを直列にすると、全体のインピーダンスはどうなるだろうか。

<P>

　いちいち式を作らなくても今までのパターンから分かるだろう。

<tex>
Z \ =\ R \ +\ j\omega L \ -\ j \frac{1}{\omega C}
</tex>

である。
　コイルとコンデンサのリアクタンスが虚軸の上で互いに打ち消す形になっており、
勝ち残った成分と抵抗とを合成する形になる。
　そんな風に考えなくても、全部の成分を複素平面上でベクトルのように足し合わせればいいわけだ。

<P>

　図形的に明らかだが、わざわざ式で表したければ、$ Z $の絶対値は、

<tex>
|Z| \ =\ \sqrt{ R^2 + \left( \omega L - \frac{1}{\omega C} \right)^2 }
</tex>

であるし、電流に対して電圧がどれだけずれるかについては、

<tex>
\tan \theta \ =\ \left( \omega L - \frac{1}{\omega C} \right) \cdot \frac{1}{R}
</tex>

という形になっている。


% =======================================================================

\section{直列インピーダンス}

　ここまでの話でパターンがつかめたと思うが、
抵抗のみ、コイルのみ、コンデンサのみのインピーダンスはそれぞれ、

<tex>
Z \ &=\ R \\
Z \ &=\ j\omega L \\
Z \ &=\ -j \frac{1}{\omega C}
</tex>

であると考えればいい。

　そしてそれらが直列になっている限りは、これらの和を作ればいいのである。
　複数のインピーダンスが直列になっている時、全体のインピーダンスは、

<tex>
Z \ =\ Z\sub{1} \ +\ Z\sub{2} \ +\ Z\sub{3}
</tex>

のようにして計算できる。


% =======================================================================

\section{並列インピーダンス}

　交流電圧と交流電流と複素インピーダンスの関係が$ V = Z\,I $という関係で結ばれているのだから、
これはパターンとしては普通の抵抗についてあれこれ計算したのと変わらないのである。

　複数の複素インピーダンスが並列に繋がれている場合には、全体のインピーダンスは、

<tex>
Z \ =\ \frac{1}{\frac{1}{Z\sub{1}} \ +\ \frac{1}{Z\sub{2}} \ +\ \frac{1}{Z\sub{3}} }
</tex>

のようにして計算できる。


% =======================================================================

\section{抵抗とコイルの並列}

　並列にした場合のインピーダンスが複素平面上ではどんなイメージになるかについても知りたいと思うことだろう。
　しかしそれは複雑すぎてあまり助けにはならない。

<P>

　一目見てみれば納得すると思うので、
試しに抵抗とコイルの並列インピーダンスについて計算してみよう。

<tex>
Z \ &=\ \frac{1}{\frac{1}{R} \ +\ \frac{1}{j\omega L}} &（この分子分母に j\omega LR をかける）\\[4pt]
&=\ \frac{j \omega LR}{j\omega L + R} \\[4pt]
&=\ \frac{j \omega LR}{R + j\omega L} \\[4pt]
&=\ \frac{j \omega LR(R - j\omega L)}{(R + j\omega L)(R - j\omega L)} &（分母を実数に変える努力）\\[4pt]
&=\ \frac{j \omega LR^2 \ +\ \omega^2 L^2 R}{R^2 + \omega^2 L^2} \\[4pt]
&=\ \frac{\omega^2 L^2 R}{R^2 + \omega^2 L^2} \ +\ j\, \frac{\omega LR^2}{R^2 + \omega^2 L^2} 
</tex>

　これで簡単にイメージできるものではないことが分かってもらえただろう。




