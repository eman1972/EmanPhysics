\field{物理数学}
\title{3Dプログラムの動作}
\comment{流行りのライブラリの仕様とは違うかもしれない。}
\prev{quaternion02}
\next{}
\create{2021/6/19 18:00}
\modify{}



\section{}



% =======================================================================

\section{オイラー座標の失敗談}

　ここまで、クォータニオンが万能であるかのように書いてきたが、
いつでもクォータニオンを使えばいいというものでもない。
クォータニオンを説明する記事だったのでクォータニオンのことしか書かなかったというだけである。

<P>

　オブジェクトにごく簡単な動きしかさせない場合には「\red{オイラー角}」を使った方が計算の負担が少ないこともある。
オブジェクトの姿勢を表すためには 3 つの角度を指定すれば十分であることが知られており、
「オイラー角」というのは、そのための 3 つの角度のことである。

\note{　クォータニオンで使ったのは、オブジェクトの姿勢を表すのに、一つの回転軸とその周りの回転角をしてやればいいという考え方であった。
（これはオイラーの定理と呼ばれていたのだった。）
この回転軸の方向を表すために 3 つの数値を使っているが、
単位ベクトルを使えば十分であり、2 つの数値があれば残りの数値も決まるのである。
回転軸を表すための数値 2 つと、回転角とで、合計 3 つの情報があればいいという点では同じである。}


　飛行機の操縦に例えて説明しよう。
飛行機の姿勢を変える方法は 3 通りあり、直交する 3 つの軸の周りの回転として区別される。
操縦席に座って右側を$ x $軸、正面を$ y $軸、上方向を$ z $軸としてみよう。

$ x $軸の周りの回転は「ピッチ」と呼ばれている。
機体を上昇させたり下降させたりするような動きである。
$ y $軸の周りの回転は「ロール」と呼ばれている。
機体を左右に傾ける動きである。
$ z $軸の周りの回転は「ヨー」と呼ばれている。
機体の進路を変えるような動きである。

<P>

　まずはラダーペダルを踏んで「ヨー」を変化させる。
次に操縦桿を引くなり押すなりして「ピッチ」を調整する。
最後に操縦桿を横に倒して機体を「ロール」させる。
こうすれば機体の姿勢は完全に決まるだろう。

<P>

　これはコックピット視点で説明したわけだが、
機体を客観的に見て同じ姿勢にする場合には逆の手順が必要である。
まずは$ y $軸周りの回転「ロール」を行う。
次に$ x $軸周りの回転「ピッチ」を行って上下角の調整を行う。
最後に$ z $軸周りの回転「ヨー」を行う。

<P>

　回転させる順番によって姿勢が変わってしまうし、
視点によっても結果が変わってしまうわけだ。


　$ x $軸周りの回転は$ yz $平面での回転なので次のような回転行列を使えばいい。

<tex>
\left(\begin{array}{c} x' \\[5pt] y' \\[5pt] z' \end{array} \right) \ =\ 
\left(\begin{array}{ccc}
1 & 0 & 0 \\[5pt]
0 & \ \cos \theta & \sin \theta \\[5pt]
0 & -\sin \theta & \cos \theta \\
\end{array} \right) 
\left(\begin{array}{c} x \\[5pt] y \\[5pt] z \end{array} \right)
</tex>

　これはオブジェクトの各点$ (x,y,z) $をワールド座標系での位置$ (x',y',z') $に回転変換するものである。





（オイラー角？）

　座標はまた別だな。





　経度と緯度が表示された天球の中にいるのと同じようなものである。

　ジンバルが文字通り固定されてしまうのである。




　全くの余談だが、他にこんな機会もあまりないのでここで話させてほしい。
自分が高校生の頃、まだコンピュータは非力であったが、とにかくコンピュータの中に世界を実現したかったのである。
何よりも、宇宙旅行に憧れていた。
都合のいいことに、宇宙は真っ黒の背景に星を描いて動かすだけで、かなり本物っぽくなるのだ。

<P>

　自分はこのコンピュータの中に作った宇宙の中で自由にぐるぐる回ってみたいと思った。
目標としては、本物の星座を背景にした宇宙戦闘ゲームを作りたかったのである。
理科年表を片手に、星の位置のデータを根気よく打ち込んだ。
出来れば星の色も再現したかったが、それは後回しだ。
高校の数学を頼りに、座標変換の行列を作り出した。

<P>

　試行錯誤の後、それは動いた。
感動だった。
オリオンの三ツ星もあった。

<P>

　しかしそれは30秒も続かなかった。

<P>

　星はじわじわカクカクと移動し、次第におかしな方向に集まり始め、一斉に飛んでいった。
誤差の蓄積が止められなかった。
次第にボロボロになっていく変換行列を解読して、
再び辻褄の合う形に戻そうとしたが、いい方法は分からなかった。



