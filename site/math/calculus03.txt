\field{物理数学}
\title{面積分と体積分}
\comment{まとめて書いてしまうと<br>実に単純なものであるという気がしてくる。}
\prev{calculus02}
\next{calculus04}
\create{2013/3/29}
\modify{}


\section{面積分のイメージ}

　高校で習った積分を拡張したものとして線積分というものを紹介した。
　しかし多変数関数$ h(x,y) $を積分するやり方は他にもある。

<P>

　積分範囲を$ xy $平面上の自由な形の内部の領域だとする。
　図を見てもらうのが早い。

\image{./calculus03/calculus3a.png,面積分の図}

　自由な形と書いたが、この図では分かりやすいように正方形領域になっている。
　この範囲内で、「$ z = h(x,y) $で表される曲面」と「$ xy $平面」に挟まれた空間の体積を求めることをしてみたい。
　どのように計算したらいいだろうか？

<P>

　まず積分範囲に指定された$ xy $平面内の領域を細かい面積に分割し、
その微小面積$ \diff S $とその地点での高さである$ h(x,y) $を掛ければ、
極めて細い柱の体積が求められるだろう。
　それらを全て合計すれば望むものが得られることになる。
　式で表すと次のような感じだ。

<tex>
\int_D h(x,y) \diff S
</tex>

　これは$ h(x,y) $と微小面積$ \diff S $の積を合計したいという気持ちを素直に表したものである。
　$ D $というのは積分範囲である$ xy $平面上の領域を表しており、今回は領域名を$ D $と名付けたというだけである。
　このように書いてみたところでまだ具体的に計算できるわけではない。
　もう少し具体的に変形することが必要だ。

<P>

　その前に、このような積分の表記にはまだ慣れていないかも知れないので、もう少し説明しておこう。
　高校で習う$ f(x) $の積分は$ \int f(x) \diff x $のように書くのだった。
　しかしひょっとするとそのような書き方をする理由については教わらなかったかも知れない。
　「積分とはそのように書き表すものだ」と教わったから何も疑問を持たずにそのように書いてきたという人もいるだろう。
　積分記号の$ \int $というのは Sum（和）の頭文字の S を縦に引き伸ばして作られた記号である。
　つまり、$ f(x) \diff x $という短冊の無限小の面積の和を取ったものだという意味になっている。
　面積分の場合でも同じような構造になっているわけだ。

\note{　ちなみに和の記号 Σ というのは S に相当するギリシャ文字である。
和の記号 Σ は離散的な量の和を表しており、積分記号 ∫ は連続的な和を表している。
それを知れば、両者は似たような使われ方をしていることが分かるだろう。}

　微小面積$ \diff S $のもっとも単純な表現の仕方は、
横幅が$ \diff x $、縦の幅が$ \diff y $であるような面積$ \diff x \diff y $の四角形として表すことである。
　積分領域$ D $を$ x $軸と$ y $軸に沿って、格子状に細かく分割したようなイメージになる。

\image{./calculus03/calculus3b.png,積分領域を微小四角形に分割するイメージを表す図}

　このイメージを採用すると$ \diff S = \diff x \diff y $と書けるから、
先ほどの面積分の式は次のように表せる。

<tex>
\int_D h(x,y) \diff S \ =\ \int \!\!\! \int h(x,y) \diff x \diff y
</tex>

　積分記号が二つになっているが、$ \diff x $と$ \diff y $とに対応しているのである。
　このような形を「\red{重積分}」あるいは「\red{2 重積分}」と呼ぶ。
　これを計算するのは簡単である。

<tex>
\int \left( \int h(x,y) \diff x \right) \diff y
</tex>

または

<tex>
\int \left( \int h(x,y) \diff y \right) \diff x
</tex>

のような形でまずはカッコの中を計算して、その結果をさらにもう一つの変数で積分してやればいいのである。
　ただし、具体的に計算するためには積分範囲を指定してやらないといけないし、
先にどちらの変数で積分するかは、積分範囲の指定の仕方によって制限を受けることになる。

<P>

　例えば次の図のような三角形の範囲で積分するとしよう。

\image{./calculus03/calculus3c.png,底面の長さが2で高さが1の三角形}

　この積分範囲を表すには$ x $と$ y $がどういう範囲を動くかを指定すればいいわけだが、表し方は二通りある。
　まずは$ x $が$ -1 \sim 1 $の範囲であることに注目するやり方だ。
　$ y $方向にどの範囲に動けるかはその場所の$ x $によって違っていて、次のように表せる。

<tex>
x\ &:\ -1 \ \leqq \ x \ \leqq \ 1 \\
y\ &:\  0 \leqq \ y \ \leqq \ 1-|x|
</tex>

　もう一つは$ y $が$ 0 \sim 1 $の範囲で動くことに注目するやり方である。
　$ x $方向にどれだけ動けるかは$ y $座標によって違っているから次のようになる。

<tex>
x\ &:\ -(1-y) \ \leqq \ x \ \leqq \ 1-y \\
y\ &:\  0 \leqq \ y \ \leqq \ 1
</tex>

　後者の方が絶対値も使ってなくてすっきりしていそうなので、そちらを使ってみたくなる。
　その場合の計算は次のように行うことになる。

<tex>
\int_0^1 \left( \int_{-(1-y)}^{1-y} h(x,y) \diff x \right) \diff y
</tex>

　カッコの中にある積分の範囲には$ y $が含まれているので、カッコ内の計算結果は$ y $を含むことになるだろう。
　しかし$ x $はこの計算で消えてしまうので、結局カッコの部分は$ y $のみの関数となるわけだ。
　その後で、$ y $による積分を実行してやればいい。
　この計算のイメージは次のようなものである。

\image{./calculus03/calculus3d.png,三角形を横に細かくスライスした図}

　先に計算するカッコの中の積分は、この図の横長の帯に沿って「線積分」を計算しているようなものだ。
　それによって、この帯から$ z $方向に突き出ている衝立（ついたて）の面積を計算できる。
　その面積に衝立の厚みである$ \diff y $を掛けたものを考え、全て合計すると、全体の体積が出ることになる。


% =======================================================================

\section{面積分を拡張する}

　今回のここまでの話は 2 次元平面での積分だったが、さらに考えを広げて高度なことをしてみたい。
　とはいうものの、アプローチは二通りある。

<P>

　上でやったような 2 次元の平面上で積分するのではなく、3 次元空間内での自由な曲面を考え、その曲面上の指定範囲で積分するのである。
　実際に計算するのは面倒だが、イメージを説明するだけなら簡単である。
　3 次元空間内の位置によって値が決まるような関数$ U(x,y,z) $を使うことになる。
　何とかして曲面を微小な面積に分割し、空間内のその点での関数の値$ U(x,y,z) $と微小面積$ \diff S $とを掛け合わせ、
その合計を計算するのである。
　これも面積分の一種であり、単に面積分と呼ぶこともあるが、
もっと正確に伝えたければ「\red{曲面積分}」とでも呼べば伝わるだろう。

\note{　曲面ではなくて 3 次元空間内の平面上で積分することもあるから、そういうものまで曲面積分と呼ぶのはイメージと違う。
そんな時は「3 次元空間内での面積分」とでも呼べばいいのではなかろうか。}


　もう一つのアプローチは、2 次元の平面上で積分するのではなく、
3 次元空間内での立体的な形を自由に考え、その形の内部領域全体で積分するというものである。
　イメージはこうだ。
　何とかして積分範囲である立体的な領域を微小な体積$ \diff V $に分割し、
その微小体積$ \diff V $とその地点での$ U(x,y,z) $との積を作り、
それを合計するのである。
　こちらは「\red{体積分}」と呼ばれる。

<P>

　どちらも簡単な例を使えば簡単に計算できるが、
曲面を式で表すのはなかなか大変で、曲面の各点の微小面積を求めるというのもさらに厄介だ。
　だから曲面積分の方が少し説明が厄介になりそうである。
　さて、どうしようか。


% =======================================================================

\section{曲面積分の方法}

　やってみるしかあるまい。
　これから曲面積分の計算の一例を説明しよう。

<P>

　曲面積分のイメージはすでに先ほど説明した。
　図に描けるようなものではないので、これ以上イメージの助けになるような説明はしない。
　まだイメージが分からない人はもう一度先ほどの文章を読み直して考えてみてほしい。

<P>

　今回は、積分範囲の曲面が$ z = h(x,y) $で表されているとする。
　曲面積分の問題がいつもこのような状況で表されるとは限らないが、割と自然な表現だと言えるだろう。
　この曲面を真上から見降ろすようにした時に
$ \diff x \times \diff y $の微小な四角形に見えるような分割をすることにしよう。
　その中の一つは例えば次の図のようになる。

\image{./calculus03/calculus3e.png,曲面の微小領域だけを切り出した図}

　極めて微細に分割したので曲面はほぼ平面と見なしても良いくらいになる。
　この「今は平面とみなせるようになった曲面の一部」の面積を計算してやりたい。
　これは長方形であるかのように見えるが実は平行四辺形であり、空間に傾いて存在している平行四辺形の面積を
正しく算出するのはなかなか面倒である。
　ただし、外積の知識があれば比較的簡単に決着が付く。

\note{　<a href="../electromag/product.html">外積についての解説はここに</a>昔書いたものがある。
本来、物理数学の一つとして今回の記事より前に入れておくべき解説なのだが、
前に書いたこの外積の説明に筆者自身がとても満足しているため、
今さら似たものをここにもう一つ書く気が起きなかったのである。}

　二つのベクトルの外積の絶対値は、それらのベクトルを二辺とするような平行四辺形の面積に等しい。
　これを使えばいい。
　図の二つのベクトルの成分はそれぞれ次のように表される。

<tex>
\Vec{a} \ &=\ \left(\ \diff x \ ,\ 0 \ ,\ \pdif{h}{x} \diff x \ \right) \\
\Vec{b} \ &=\ \left(\ 0 \ ,\ \diff y \ ,\ \pdif{h}{y} \diff y \ \right) 
</tex>

　これらの外積を計算すると次のような結果となる。

<tex>
\Vec{a} \times \Vec{b} \ =\ \left( -\pdif{h}{x} \diff x \diff y \ ,\ -\pdif{h}{y} \diff x \diff y \ ,\ \diff x \diff y \right)
</tex>

　このベクトルの絶対値はこうだ。
　簡単に計算できるね。

<tex>
|\Vec{a} \times \Vec{b}| \ =\ \sqrt{1 + \left( \pdif{h}{x} \right)^{\!\!2} + \left( \pdif{h}{y} \right)^{\!\!2} } \ \diff x \diff y \\
</tex>

　これが曲面の微小面積$ \diff S $に等しいのであるから、曲面積分は次のように変形して計算すれば良いことになる。

<tex>
\int U(x,y,z) \diff S \ =\ \int \!\!\! \int U(x,y,h(x,y)) \ \sqrt{1+\left(\pdif{h}{x}\right)^{\!\!2} + \left(\pdif{h}{y}\right)^{\!\!2} } \ \diff x \diff y
</tex>

　被積分関数$ U(x,y,z) $と積分領域の形を表す$ h(x,y) $が具体的に指定されれば、
あとの計算は最初にやったのと同じように出来るだろう。
　重積分の順序は曲面の範囲を$ xy $面でどのように指定するかに掛かっている。

<P>

　ここでは公式のようなものを導いてしまったが、覚える必要はない。
　基本的なイメージは前節で少しだけ話したものが全てであり、
状況に合わせてこのような具合に考えて何とかして行くのである。
　もちろん、今回の結果はよく使うものなので覚えておいても損はないだろう。

% =======================================================================

\section{体積分の方法}

　体積分は曲面積分よりもずっと簡単だ。
　積分領域をどのように分割して微小体積$ \diff V $を考えるかというのが問題だが、
もっとも単純には格子状に分割して、微小な直方体の集まりを考えれば良いだろう。
　微小体積$ \diff V $は次のように表せる。

<tex>
\diff V \ =\ \diff x \diff y \diff z
</tex>

　このやり方を採用した場合には次のように変形して計算すれば良いことになる。

<tex>
\int U(x,y,z) \diff V \ =\ \tint U(x,y,z) \diff x \diff y \diff z
</tex>

　立体的である積分領域をどのように表現するかは工夫次第で腕の見せ所だ。
　例えば、原点を中心とした半径 1 の球の内部全体の領域を表現したければ次のように範囲を指定することになる。

<tex>
x\ &:\ -\sqrt{1-z^2-y^2} \ \leqq \ x \ \leqq \ \sqrt{1-z^2-y^2} \\
y\ &:\ -\sqrt{1-z^2} \leqq \ y \ \leqq \ \sqrt{1-z^2} \\
z\ &:\ -1 \leqq \ z \ \leqq \ 1
</tex>

　なぜこうなるのかを考えたくなければ、別に重要なことでもないので考えなくてもいい。
　あれこれ分析するよりも自分で作ってみた方が早かったりもするだろう。

<P>

　一応思考過程を書いておこう。
　球を$ z $軸に垂直な面でスライスすると円板になるので、
厚み$ \diff z $の円板を重ねていけば球になるのだろうとまず考えた。
　その円板の半径$ r $をどう表したらいいのかを考える必要があるが、
半径 1 の球面を考えているので$ z^2 + r^2 = 1 $を満たすだろう。
　だから$ r = \sqrt{1-z^2} $だ。
　次に半径$ r $の円板を$ y $軸に垂直にスライスしてゆくことを考える。
　幅$ \diff y $の多数の棒になるはずだ。
　その時の棒の長さを$ x $の範囲として使えばいい。
　半径$ r $の円なのだから$ x^2 + y^2 = r^2 $を満たすだろう。
　つまり$ x = \sqrt{r^2-y^2} $であり、$ r $は$ r = \sqrt{1-z^2} $だったから、
$ x $は$ \pm \sqrt{1-z^2-y^2} $に挟まれた範囲である。
　まぁ、こんな具合であり、とても面倒くさい。

<P>

　これを使って計算するつもりであれば、次のようなものを解くことになる。

<tex>
\int_{-1}^{1} \left( \int_{-\sqrt{1-z^2}}^{\sqrt{1-z^2}} \left( \int_{-\sqrt{1-z^2-y^2}}^{\sqrt{1-z^2-y^2}} U(x,y,z) \diff x \right) \diff y \right) \diff z
</tex>

　もし$ U(x,y,z) = 1 $としてこの計算をしたならば、半径 1 の球体の体積である$ \frac{4}{3}\pi $が導かれるはずだ。
　（しかし私は面倒だったのでこの検算をやめた。）

<P>

　状況によってはこのような分割の仕方よりもずっと楽な場合がある。
　特に、今回のような球状の範囲を考えるなら極座標を使った方が遥かに効率的になるかも知れない。
　次回はそういうものをあれこれと紹介することにしよう。



