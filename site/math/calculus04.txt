\field{物理数学}
\title{ヤコビアン}
\comment{座標系の選択による違い。}
\prev{calculus03}
\next{taylor}
\create{2013/4/10}
\modify{}


\section{極座標（円座標）}

　前回の記事では微小面積$ \diff S $や微小体積$ \diff V $を分割するときに、
徹底してデカルト座標を使ってきた。
　「\red{デカルト座標}」というのは座標軸が直線で互いに直交しているという、
中学や高校の数学でも使っているごく普通の座標のことである。

\note{　デカルト座標のことを、直交座標とか、より正確に「直交直線座標」だとか呼ぶこともある。
（軸が曲線だけど互いに直交するような「直交曲線座標」というものもあるからである。）
英語での表現をそのまま使って「カーテシアン座標」と呼ぶこともある。
英語では「デカルトの」という形容詞は Cartesian （カルテジアン/カーテシャン）と綴るからである。
人名のデカルトの綴りは Descartes だが、Des の部分はフランス語の冠詞にあたるので省かれているわけだ。}

　要するに、前回は$ \diff S $や$ \diff V $を次のように表現し直して計算したのであった。

<tex>
\diff S \ &=\ \diff x \diff y \\
\diff V \ &=\ \diff x \diff y \diff z
</tex>

　さて、デカルト座標の他にも座標軸の引き方は色々あって、
有名なのが、原点からの距離$ r $と方位$ \theta $で表す「\red{極座標}」というものである。

\image{./calculus04/calculus4a.png,極座標の説明図}

　極座標で表した点$ (r,\theta) $とデカルト座標で表した同一の点$ (x,y) $との間には次のような関係が成り立っている。

<tex>
x \ &=\ r\,\cos \theta \\
y \ &=\ r\,\sin \theta
</tex>

　このような極座標で、座標値である二つの値$ (r,\theta) $をともに少しだけ動かすことを考えよう。
　その幅をそれぞれ$ \diff r $と$ \diff \theta $で表すことにする。
　その様子は次の図のようになるだろう。

\image{./calculus04/calculus4b.png,極座標の微小領域の説明図}

　この図の水色の部分$ \diff S $の面積は正確に計算すると

<tex>
\diff S \ &=\ \pi (r+\diff r)^2 \times \frac{\diff \theta}{2\pi} \ - \ \pi r^2 \times \frac{\diff \theta}{2\pi} \\
&=\ \left[(r+\diff r)^2 \ - \ r^2 \right] \times \frac{\diff \theta}{2} \\
&=\ \left[ 2r\diff r \ +\ (\diff r)^2 \right] \frac{\diff \theta}{2} \\
&=\ r \diff r \diff \theta \ +\ \frac{1}{2}(\diff r)^2 \diff \theta 
</tex>

となるわけだが、第 1 項は微小量が 2 つ掛け合わされて出来ているのに対し、
第 2 項は 3 つの微小量が掛け合わされており、一つ多い。
　つまり微小量が無限に小さい極限を考えると、
第 2 項は第 1 項よりもずっとずっと小さくて無視できるほどになる。

<P>

　図を見ても$ \diff S $の部分は縦と横の長さがそれぞれ$ \diff r $と$ r\diff \theta $であるような長方形に
似ていることが分かるだろう。
　長方形には見えないかもしれないが、微小幅を無限に小さくするとほぼ長方形だとみなせるようになり、
長方形とのズレはどんどん無視できるようになる。
　このような無数の微小面積の集まりとして平面を埋め尽くす様子をイメージすれば、面積分が出来そうだ。

<tex>
\diff S \ =\ r \diff r \diff \theta
</tex>

のように表して計算すれば良いのである。

<P>

　例えば半径$ a $の円形領域で関数$ h(x,y) $を面積分したければ、

<tex>
\int h(x,y) \diff S \ =\ \int_0^{2\pi} \left( \int_0^a  h(r\cos \theta, r\sin \theta) \ r \diff r \right) \diff \theta
</tex>

のような計算をすることになる。
　積分範囲が円形をしている場合には、このように極座標を使った方が範囲の指定がとても楽に出来る。

<P>

　さらに関数$ h(x,y) $が原点を中心として回転対称な関数である場合には、
関数は$ \theta $には関係のない形になっている。
　つまり実質$ h(r) $ということなので、計算はずっと楽になるだろう。
　被積分関数の中に$ \theta $が含まれていないのだから、次のように$ \theta $の積分だけ先にやってしまえる。

<tex>
\int_0^{2\pi} \left( \int_0^a  h(r) \ r \diff r \right) \diff \theta 
\ &=\ \int_0^{2\pi} \!\! \diff \theta \ \ \int_0^a  h(r) \ r \diff r \\
&=\ 2\pi \int_0^a  h(r) \ r \diff r 
</tex>

　このように、積分範囲の形や関数の形に応じて計算に最も都合の良い座標を選ぶことが重要になってくるわけだ。


% =======================================================================

\section{3 次元極座標（球座標）}

　3 次元にも極座標がある。
　やはり原点からの距離と角度で位置を指定するのだが、次の図のように考えるのが一般的である。

\image{./calculus04/calculus4c.png,3次元極座標の説明図}

　これは地球上の位置を表すときの緯度と経度に似ている。
　$ \theta $は緯度に似ているが、赤道を基準に北と南にプラスマイナスで表すのではなく、
北極を 0 として 180°の範囲で動くところが違う。
　つまり$ \theta $の変域は$ 0 \sim \pi $である。
　$ \phi $は経度に似ているが、東経や西経があるわけではなく、$ 0 \sim 2\pi $の範囲で一周することになる。

<P>

　同一点を表す$ (x,y,z) $と$ (r,\theta,\phi) $の関係は次のようになっている。

<tex>
x \ &=\ r \sin \theta \cos \phi \\
y \ &=\ r \sin \theta \sin \phi \tag{1}\\
z \ &=\ r \cos \theta
</tex>

　慣れるために、本当にそうなっていることをちゃんと確認しておいてほしい。
　図で$ xy $平面上に描いてある点線の長さが$ r \sin \theta $であることに気付けばあとは簡単だろう。

<P>

　さて、先ほどと同じように微小範囲のことを考えてみよう。
　少しややこしくなるが根気よく考えて付いて来てほしい。
　$ (r,\theta,\phi) $の点から$ (\diff r, \diff \theta, \diff \phi) $の幅だけ増加させた時に
新たに出来る微小範囲は次の図のようになる。

\image{./calculus04/calculus4d.png,3次元極座標の微小領域の説明図}

　これは幅を無限に小さくする時には
縦、横、高さがそれぞれ$ \diff r $、$ r \diff \theta $、$ r \sin \theta \diff \phi $の直方体だと考えることができる。
　図がややこしくなることを恐れて情報をあまり書き込んでいないが、どこの長さが幾つになるか分かるだろうか？
　初めて見た人にとっては簡単だとは思えないから、パズルのようなものだと思ってじっくり考えてほしい。

<P>

　順番に考えれば簡単だ。
　$ r $が微小量$ \diff r $だけ伸びる方向というのはすぐに分かるだろう。
　次に$ \theta $がどこの角度のことかを確認したら、
それがわずかに$ \diff \theta $だけ増加するというのがどこを指しているかも分かる。
　その角が張る円弧の部分が$ r\diff \theta $だ。
　もう一つの辺の長さがなぜ$ r \sin \theta \diff \phi $なのかは、少しややこしい。
　どこが$ \diff \phi $でどこが$ r \sin \theta $であるのかが分かれば理解できるだろう。

<P>

　これにより、微小体積$ \diff V $を次のように解釈することができるようになる。

<tex>
\diff V \ =\ r^2 \sin \theta \diff r \diff \theta \diff \phi
</tex>

　これを使って積分範囲の空間を埋めることを考えれば、
前回複雑に範囲指定した半径 1 の球状の体積分は次のように表せる。

<tex>
\int U(x,y,z) \diff V \ =\ \int_0^{2\pi} \left( \int_{0}^{\pi} \left( \int_0^1 U(r,\theta,\phi) \ r^2 \sin \theta \diff r \right) \diff \theta \right) \diff \phi
</tex>

　$ U(r,\theta,\phi) $というのは$ U(x,y,z) $の各変数を極座標の変数に書き換えて出来る関数のことだが、(1) 式を使えばいい。
　面倒なのでこのように表すことにした。
　もとから$ (r,\theta,\phi) $の関数として表されたものが与えられていればそのまま使えばいい。
　関数の形によっては前回デカルト座標でやったよりもずっと簡単に計算できそうだ。

<P>

　$ U(r,\theta,\phi) = 1 $を使って半径$ R $までの範囲で計算すれば、これまで公式として暗記していた球の体積が簡単に導き出せる。
　また天体の密度が半径だけで決まると考えてそれを$ U(r) $で表せば、天体の全質量が計算できたりもする。

% =======================================================================

\section{円筒座標（円柱座標）}

　3 次元空間の座標としてよく使うのが他にあるので紹介しておくとしよう。

<P>

　$ xy $面内での位置を 2 次元極座標のように$ r $と$ \theta $で表し、
$ z $方向の位置をデカルト座標の値をそのまま使って$ (r,\theta,z) $で表すやり方である。
　これを「\red{円筒座標}」あるいは「\red{円柱座標}」と呼ぶ。

<P>

　これで話が通じているか少し不安なので念のため言っておくと、
$ r $は原点からの距離ではなく、$ z $軸からの距離を表していることになる。
　デカルト座標との関係は次のようになっている。
　今回は図はないので、自分の理解が正しいかどうか確認してもらいたい。

<tex>
x \ &=\ r \cos \theta \\
y \ &=\ r \sin \theta \\
z \ &=\ z
</tex>

　さて、この座標を使って微小領域を考えると次のようになる。

\image{./calculus04/calculus4e.png,円筒座標の微小領域の説明図}

　つまり微小体積は次のように表せるということになる。

<tex>
\diff V \ =\ r \diff r \diff \theta \diff z 
</tex>

　あとは同じ事だから積分の仕方などはもう言わなくてもいいだろう。

% =======================================================================

\section{2 次元座標の紹介}

　他にも座標の種類は色々とあるのでざっと紹介しておこう。
　ただし簡単に済ませたいので 2 次元に限定することにする。

<P>

　座標軸が直交していないような座標の取り方もあることを話しておきたい。
　次の図のように$ y $軸だけが傾いているようなものを考えよう。

\image{./calculus04/calculus4f.png,斜交座標の説明図}

　これは最も単純な「\red{斜交座標}」の例である。
　この座標では$ X $軸に平行な多数の線と、$ Y $軸に平行な多数の線によって座標を読むことになる。
　つまり、ある地点の座標を読みたければ、図にある点線のように線を引いて、それぞれの座標軸に書かれた数値を読むのである。
<P>

　この座標で表現された位置$ (X,Y) $とデカルト座標で表された位置$ (x,y) $との関係はややこしいので書く気が失せた。
　今回の話とは関係ないし、わざわざ書くほどのものでもない。
　知りたい人は自力でやってみると頭の体操になるだろう。

<P>

　この他に<a href="https://en.wikipedia.org/wiki/Elliptic_coordinate_system">楕円座標</a>や
<a href="https://en.wikipedia.org/wiki/Bipolar_coordinates">双極座標</a>なども紹介しようと思っていたが、
もともと詳しく説明する気はなかったし図を描くのが大変だったのでWikipediaへのリンクでごまかすことにした。
　そんなものもあるのだな、というくらいに眺めてもらったら良いと思う。


% =======================================================================

\section{ヤコビアン}

　このように色々な座標の取り方があることが分かったと思うが、
そのたびに図を描いて微小面積や微小体積がどう表せるかを考えるのは面倒である。
　もちろんそういうイメージをしっかり思い描くのは大切なことなのだが、
時には具体的なイメージがそれほど重要でないこともある。
　単にその場限りの計算の都合で、ある座標を導入した方が楽に計算できるとかいう場合だ。

<P>

　そういう場合に便利な、微小面積や微小体積の表し方を機械的に導く方法がある。
　3 次元極座標を例にして考えてみよう。
　次のような行列を考える。

<tex>
J \ =\ \left(
\begin{array}{ccc}
\pdif{x}{r} & \pdif{x}{\theta} & \pdif{x}{\phi} \\[6pt]
\pdif{y}{r} & \pdif{y}{\theta} & \pdif{y}{\phi} \\[6pt]
\pdif{z}{r} & \pdif{z}{\theta} & \pdif{z}{\phi}
\end{array} \right)
</tex>

　このような行列を「\red{ヤコビ行列}（ヤコビアン）」と呼ぶ。
　ここに (1) 式を具体的に代入し、その行列式を計算してみよう。

<tex>
|J| \ =\ \left|
\begin{array}{ccc}
\sin\theta \cos \phi & r \cos\theta \cos\phi & -r \sin\theta \sin\phi \\[6pt]
\sin\theta \sin \phi & r \cos\theta \sin\phi & r \sin\theta \cos\phi  \\[6pt]
\cos \theta          & -r \sin\theta         & 0
\end{array} \right|
\ =\ r^2 \sin \theta
</tex>

　先ほど 3 次元極座標を紹介した時に見た微小体積の因子が計算だけで導かれてきた。
　なぜこんなことが出来るのだろうか？

<P>

　行列式の意味というのは、各列、または各行の成分をベクトルだと見た時に、
それらのベクトルが作る平行六面体（2 次元の場合には平行四辺形）の体積（面積）を表しているのだった。
　ここでは縦一列を一つのベクトルと見て考えてみよう。

<P>

　$ (\pdif{x}{r},\pdif{y}{r},\pdif{z}{r}) $というベクトルは、
変数$ r $が増加した時に、その様子がデカルト座標ではどの方向に増加するように見えるのかを表すベクトルである。
　$ \diff r $だけ増加した場合には、
そのベクトルに$ \diff r $を掛けたものがデカルト座標での変化量になるが、ここではまだ掛けられてはいない。
　このヤコビ行列の中には、同様に、$ \theta $が増加した場合のデカルト座標での方向、$ \phi $が増加した場合のデカルト座標での方向を
表すベクトルがあり、$ |J| $というのはそれらに挟まれて出来る平行六面体の体積を表していることになる。

<P>

　$ r $や$ \theta $や$ \phi $がわずかに変化するときに、
その体積は$ \diff r $や$ \diff \theta $や$ \diff \phi $に比例するのだから、
$ |J| \diff r \diff \theta \diff \phi $と表されることになる。
　これはデカルト座標における長さの指標で測った微小体積$ \diff V $を意味するので、
デカルト座標で表現された積分を次のように書き換えることができるだろう。

<tex>
\tint U(x,y,z) \diff x \diff y \diff z \ =\ \tint U(r,\theta,\phi) \ |J| \ \diff r \diff \theta \diff \phi \tag{2}
</tex>

　これを見ると、あたかも次のような関係が成り立っているかのように思えるが、そういうわけではない。

<tex>
\diff x \diff y \diff z \ =\ |J| \ \diff r \diff \theta \diff \phi \tag{3}
</tex>

　この (3) 式の左辺はデカルト座標での微小な直方体領域の体積であり、
一方、右辺は極座標の変数を動かした時に出来る形の微小体積であり、それぞれの微小体積の大きさは互いにまるで関係がない。
　関係ないのだから、等号でつなぐようなものではない。
　ここまでの説明はあくまでも (2) 式のような積分の変数の変換の形にして成り立つ話である。

\note{　・・・とは言ったものの、今回のような直接的イメージに頼るのではなく、
もう少し抽象的な解釈を取る場合には (3) 式のような表現をするのも許容範囲だという意見もある。
ただし特殊な考え方で扱わねばならず、その意味の分からぬままにこの表現を一人歩きさせることは混乱の元だと私は思う。<br>
　多様体論などを学び微分形式というものを理解したり、
ルベーグ積分などを学び測度というものを理解すると、この辺りの雰囲気が良く分かるようになるのだそうだ。}

　(2) 式のような変換が可能だとは言っても、
積分範囲が複雑な形をしている時には、ちゃんと対応する範囲を考えて積分範囲を考え直さないといけないので大変ではある。
　しかし積分範囲が空間の全体だったりすることもよくあり、その場合には何も考えなくていいからとても楽である。

<P>

　ヤコビ行列$ J $の行列式$ |J| $のことを「\red{ヤコビ行列式}」と呼ぶ。
　先ほど、ヤコビ行列が出てきたところに括弧書きでヤコビアンと書いてあったが、
ヤコビアンと言えばヤコビ行列式のことを指すこともある。
　ヤコビアンというのは「ヤコビの」という意味だからどちらにも使うわけだ。

<P>

　ヤコビアンを$ |J| $と書く代わりに次のように表記することもある。

<tex>
|J| \ \equiv\ \left|\pdif{(x,y,z)}{(r,\theta,\phi)}\right| 
</tex>

　これはヤコビアンが偏微分の拡張だというイメージを強調するような記法である。
　そのイメージを持っていれば、もしヤコビアンの定義を忘れてしまってもすぐ思い出せるだろう。
　(3) 式の形を思い出せば間違えない。
　また、行と列のどちらがどうだったかという部分が思い出せなくて悩むことは良くあるが、
それで計算を中断する必要はない。
　行列式の計算は行列が転置していても同じ結果にたどり着くからだ。

% =======================================================================

\section{積分の変数変換}

　ここではヤコビアンの例としてデカルト座標と 3 次元極座標との間のことを考えたわけだが、
いつもデカルト座標を介する必要もない。
　同様の理屈は他の座標系どうしでも成り立つことになる。

<P>

　というわけで、このヤコビアンの目的は単に微小体積の表現の仕方を導くだけにはとどまらない。
　\red{重積分するときの変数の組を別の変数の組に置き換えるという目的にも広く使えるのである。}
　変数の変換規則さえ分かっていればそれを使ってヤコビアンが計算できるだろう。
　(2) 式は変数が変わってもそのまま使える式である。

% =======================================================================

\section{高校でやった置換積分}

　今、ヤコビアンが重積分の変数変換に使えるという話をしたが、1 変数の積分の場合にも当てはまる。
　高校の数学で置換積分と呼ばれていたものがまさにそれだ。

<P>

　置換積分は高校で習った時にはとても分かりにくかった気がするが、
ヤコビアンの最も単純な場合だと考えれば実に簡単な話だ。
　その場合のヤコビアンは 1 行 1 列になり、変数が一つだから偏微分で表す必要もなくなり、ただの微分になる。

<P>

　例えば、元々変数が$ x $だったものを、別の変数$ t $を使ったものに書き換えたければ、
$ x $と$ t $の関係が$ x = g(t) $のように書けるものだったとして・・・。
　そうか・・・なるほど。
　具体的に説明しようとすると高校の教科書と変わらない説明になってしまうのだな。
　面白くないからやめておこう。
　言いたいことは伝わっただろう。


