\field{流体力学}
\title{バロトロピー流体}
\comment{使える式をただ使うという単純な考えでも<br>いいのだけどさ。}
\prev{energy_eq}
\next{matome1}
\create{2020/9/24 11:45}
\modify{}


\section{ここで熱力学の話をすべきか}

　前回は、エネルギー保存則を適用すれば流体の運動に制限が付けられるのではないかと考えて試してみたのだった。
しかし粘性による摩擦熱の発生や圧縮による内部エネルギーの増加などを考慮しなければならず、
熱力学との関係が出てきてしまった。
流体の熱力学的な内部状態まで考えようとすると新たな未知関数が加わってしまうのである。
これは困った事態だ。

<P>

　解決のために熱力学についての議論をしたいところだが、
「流体力学を学ぶためにまずは熱力学を一通り理解してきてください」という話の流れはできるなら避けたい。
深くまで学ぼうとすればいずれは必要になるのかもしれないが、
今はまだ全体像を簡単に把握しておきたいだけなのである。

<P>

　ここでざっと熱力学の説明を始めようかとも思ったのだが、短く正確にというのはとても難しいと分かった。
注釈に注釈を重ねるような、大変読みにくい話になってしまう。
しかも私自身が熱力学を正確に把握できているとは言い難い状況である。

<P>

　\red{というわけで、結論から話してしまおう。}

<P>

　エネルギー保存則の式だけでは熱力学的な変数の関係を十分に縛ることができない。
<b>詳しくは後で話そう。</b>
そういうわけだから、さらに等温条件やら断熱条件やらの条件を付けることで、
エネルギー保存則の式をその場その場で都合よく変形して利用することになる。

\note{　幾つかの教科書ではエネルギー保存則の式を冒頭で天下り的に出してくるものがある。
しかしそれをそのままの形で使っている様子もないし、
変形後の式を連立方程式の一つとして利用して解こうとする様子もない。
ところどころの議論の援用に使うだけであったりする。
色んな式と混ぜていって元とは全く違う形の式として利用したりするので、
結局エネルギー保存という意味合いも薄れてしまって、どういう使い方をしているのかを追えなくなってしまう。}

　\red{エネルギー保存の式は成り立っているが、
考える範囲を広げ過ぎてしまっているために、もう単独では使い物にならないのである。}
条件を加えるにしても、状況によりさまざまなので、統一的な議論にも向かない。
個別の議論ではたまたますごく便利に使えることもあるという感じなのだと思う。

\note{　これについては私自身がまだ流体力学の運用に慣れ親しんでいないので、
あちこちの教科書を眺めてみた感想にすぎない。
あとで訂正が必要になるかもしれない。<br><br>

　「熱の散逸を考慮に入れる場合にはエネルギー保存の式が便利である」という記述はあっても、
本当に便利だと思える例を私はまだ見せてもらっていない。
ではエネルギー保存則を使わなければ散逸がある場合を扱えないのかというと、そうでもなさそうである。
エネルギー保存そのものは式を利用するしないにかかわらず成り立っているはずだからだ。}


　エネルギー保存の式を使ってもさらに何らかの条件を追加しなくてはならないのだとしたら、
初めから未知関数を少しも増やさない形で何らかの条件を追加した方がマシである。
そんなことができるのかどうか、どこまで現実に近い条件が作れるかを考えてみることにしよう。

% ===========================================================

\section{バロトロピー流体}

　密度$ \rho $が圧力$ p $のみの関数として表せるという仮定を考える。

<tex>
\rho \ =\ \rho(p) \tag{1}
</tex>

　こうすれば新しい未知関数を増やさないままで条件を追加できる。
この条件に従う流体のことを「\red{バロトロピー流体}」と呼ぶ。
おかしな名前だが、バロという部分がバロメーターなどのように気圧を意味していて、
トロピーという部分はエントロピーと同じように変換を意味するギリシャ語に由来しているのだろう。
つまり、「圧力の関数」くらいの意味だと思われる。

\note{　これは流体そのものの性質というよりは、流れている状況全体の中でこの仮定が使えるかどうかという話なので、
いつでもバロトロピー流体と呼べるような特殊な流体が存在するというわけでもない。
そういう点では前に出てきた「ニュートン流体」「非ニュートン流体」とかいう分類とはまたちょっと違う。
だから「バロトロピー流れ」だとか「（状況が）バロトロピックである」とかいう表現がされることも多い。}

　密度$ \rho $は体積と逆数の関係にあるのだから、(1) 式は体積と圧力の関係を表している。
つまりこの仮定は熱力学に出てくる$ p\,\text{-}\,V $グラフ上に一本の曲線を描くのと同じような意味である。
シンプルな仮定ではあるが、かなり色々な条件下での変化を$ p\,\text{-}\,V $グラフ上の曲線として表せるのではないだろうか。

<P>

　密度$ \rho $が圧力$ p $に関係なく常に一定であるという特殊な状況もまたバロトロピー流体の一種に含めるということにしておこう。

<tex>
\rho \ =\ C \tag{2}
</tex>

　液体は圧力を掛けてもほとんど体積が変化しないのでこのような仮定が妥当であることが多い。

<P>

　熱力学的な平衡状態を保ちながら体積や圧力を変化させていく気体の状態変化というのは$ p\,\text{-}\,V $グラフ上を移動していく点として表せる。
だとすればあらゆる流体がバロトロピー流体であるような気がしてしまうが、
バロトロピー流体でない流体というのは存在しているのだろうか？ 
それはどういうものだというのだろうか？

<P>

　話は単純である。
$ p\,\text{-}\,V $グラフ上の定まった曲線の上に乗って変化するという条件を満たせなければバロトロピー流体ではない。
例えば外部から熱が加えられたり、粘性による摩擦熱が発生して、それをすぐに流体の外に排熱できなければ、異なる曲線上を動くようになる。
そうなると密度が$ p $のみの関数であるという条件から外れてしまう。
たとえ熱の出入りがあったとしても、例えば定温条件が守られた上での変化であれば常に一定の曲線上を動くので問題ないであろう。
そういうことである。

<P>

　他の可能性としては、熱平衡が保てないほど流れが乱れているという状況がありうる。
しかしそれはもはや通常の流体力学が扱う状況ではないだろう。
流体力学は十分に多数の分子の動きが平均化されて圧力や密度などがきちんと定義されるような状況を想定しているのだった。

<P>

　他にもバロトロピー流体と呼べない特殊な状況があり得る。
例えば、温度が大きく異なる流体が入り混じるような場合である。
温度によって密度が影響を受けることは普通によくあることで、
これは密度$ \rho $が圧力$ p $だけでなく温度$ T $の関数にもなっているのだから仮定に合わない。
しかし流体全体がほぼ一定温度ならそんなことは気にしなくてもよくて、バロトロピー流体とみなせるだろう。

<P>

　今、温度が異なる流体が混じる場合はバロトロピー流体とみなせないようなことを言ったが、
流体が断熱的に圧縮されて他に熱を逃がす暇もなく一時的に温度が上がる場合などはバロトロピー流体と考えてもいい。
膨張すればまた元の温度に戻るだろうし、そのような断熱変化は$ p\,\text{-}\,V $グラフ上の定まった曲線の変化として表せるからだ。

<P>

　これでバロトロピー流体のイメージはつかんでもらえただろうと思う。

% ===========================================================

\section{具体的な条件式}

　もう少しイメージを具体化するために、
幾つかの場合について (1) 式を具体的に書き表してみることにしよう。

<P>

　具体的に表すためには具体的な仮定が必要で、以下では次のような状態方程式に従う理想気体を仮定しよう。

<tex>
p\,V \ =\ n\,R\,T \tag{3}
</tex>

　$ n $はモル数、$ R $は気体定数、そして$ p $は圧力、$ V $は体積、$ T $は温度である。

<P>

　\red{まずは等温変化である場合について考えよう。}
これは、外界の温度が一定で、流体の熱伝導率が高くて、
十分な熱のやり取りをしながら常に熱平衡に達しているとみなせるくらいにゆっくり流れる場合に良くあてはまる仮定である。
(3) 式の$ T $が一定で、$ \rho $と$ V $とは逆数の関係にあるので、
$ \rho $と$ p $の間には

<tex>
\rho \ =\ C \, p \tag{4}
</tex>

という比例関係が成り立つ。

\note{　この比例定数 C がどんな値になるかをもっと具体的に知っておきたい。
気体の質量を M [kg] だとすれば、ρ = M/V なので、V = M/ρ である。
これを (3) 式に代入して少し変形すれば ρ = (M/(nRT)) p である。
気体の分子量を m とすると、n モルの質量は M = 0.001 m × n なので、ρ = 0.001 × (m/(RT)) p となる。
C = 0.001 × m/(RT) を使えばいいようだ。
実用重視の工学の公式っぽくて理論的な美しさに欠けるせいか教科書には書かれていなかったりする。}

<P>

　\red{次は断熱変化である場合について考えよう。}
これは外界からの熱や粘性による摩擦熱の発生がほとんど無視できる場合、
そして流体の熱伝導率が低くて、流体中を熱が伝わることもほとんどない場合に当てはまる。
熱の出入りがないことから「\red{等エントロピー流れ}」とも呼ばれる。

<P>

　その場合の式をここで一から導出しようかと思ったが、かなり面倒なので諦めた。
熱力学での議論に頼ってほしい。
このサイトでは熱力学の「<a href="https://eman-physics.net/thermo/adiabatic.html">断熱過程</a>」という記事で次のような関係を導出している。

<tex>
pV^{\gamma} \ =\ 一定 \tag{5}
</tex>

　この式は「ポアッソンの式」と呼ばれており、やはり (3) 式で表されるような理想気体を前提としている。
$ \gamma $は比熱比である。

<tex>
\gamma = \frac{C_p}{C_v} \tag{6}
</tex>

　(5) 式の$ V $を密度$ \rho $に書き換えると、

<tex>
\rho \ =\ C \,p^{1/\gamma} \tag{7}
</tex>

という形になる。
この定数$ C $は圧縮開始時の温度や圧力によって異なる値になるようなものなので、
実際の問題に取り組むときに与えられた条件から決めることになる。
こういう説明の段階では具体的に表そうとしない方がいいだろう。

<P>

　ここでは具体例ということで理想気体を仮定して式を導いてみたが、
理想気体でなくてもおおよそ似たような傾向があるし、
このような式からずれていたとしてもバロトロピー流体であると認められる状況は多い。

<P>

　よっぽど密度の高い場合でなければ理想気体だと仮定することは問題ないだろう。


% ===========================================================

\section{熱力学の構造}

　さて、必要なことはほとんど話し終えた。
今回の記事の始めの方で予告しておいたように、熱力学がどういうものかについてざっと説明しておくことにしよう。
ここまでの話で納得の行った人はこの先は読む必要はない。
私自身が悩んだことを、誰かの役に立つように書き残しておくような感じである。

<P>

　理路整然とまとめることが難しいので、やや箇条書きっぽく書いていくことにしよう。

<P>


　前回はエネルギー保存則の式を作ろうとした結果、熱力学の第 1 法則と同じ形の式が勝手に出てきたのだった。
熱力学の第 1 法則というのはエネルギー保存則を意味していたので、そうなるのは当然と言えば当然だ。

<P>

　熱力学には状態方程式が出てくるが、これは熱力学の第 1 法則から導き出されるようなものではない。
それはどこからも導き出されず、そのような関係式が存在することは「仮定」である。

<P>

　熱力学の第 1 法則は気体に与える熱や仕事についての記述であり、
状態方程式に従う気体に対してそれを当てはめることで議論が進む。

<P>

　理想気体の状態方程式には圧力$ p $、体積$ V $、モル数$ n $、温度$ T $が入っている。
もしも物質の出入りが無ければ、$ p $、$ V $、$ T $という 3 つの変数の関係を縛る式だと言える。

<P>

　流体力学では容器が密閉されているわけでもなく、いかにも物質の出入りがありそうだが、実際にはそうではない。
ラグランジュ微分という、一定量の物質を追いかける形で関係を記述することが可能である。
つまり、一定量の物質の体積変化、圧力変化、温度変化を論じることができるのだから、
物質の出入りがない熱力学を当てはめて考えればいい。

<P>

　今しばらくは熱力学の話なのでそのまま体積$ V $を使って話すことにするが、
流体力学では代わりに密度$ \rho $を使っている。
互いに逆数の関係にあるので本質的には同じものである。
もし必要ならところどころで読み替えて考えてもらいたい。

<P>

　状態方程式は 3 つの変数の自由度を一つ縛っている。
つまり気体の状態は変数 2 つ分の自由度を持つことになる。

<P>

　さて、今言ったことが正しいのかどうかがちょっと心配になってきた。
「熱力学状態は 2 つの状態変数によって定まる」というのは良く聞く話である。
理想気体の状態方程式を見ている限りでは確かにそのようであるが、本当だろうか？ 
実在気体の状態方程式はもっと複雑である。
実在気体を表す近似式は複数種類が提案されているから、ここでそのうちの一つを例に挙げて説明するのはやめておこう。

<P>

　とにかく、実在気体の状態方程式は単純な 1 次式ではないので、温度と圧力を指定しても、複数の体積が当てはまったりする。
同じ温度や圧力の中で液体や固体のように体積（密度）が異なる状態が存在する理由を、
このような実在気体の方程式で定性的に説明するのを見たことがある。
それがどこまで妥当なのか、ちょっとよく分からない。

<P>

　ちょっと横道に逸れてしまった。
本当に知りたいことは、
「2 つの変数によって状態が定まる」というのは熱力学の根本的な仮定の一つだと考えていいものだろうか、というものだ。

<P>

　幾つかの教科書を調べ直してみると、この点があっさり導入されているものが多くて気付きにくい。
田崎の有名な教科書『<a href="https://www.amazon.co.jp/dp/4563024325/?tag=emansphysics-22">熱力学</a>』では
独自の哲学的指針を交えながら慎重に議論されているため、このことの重要性に気付きやすくなっている。
この教科書によると、示量変数であるモル数、体積と、熱平衡の状態を特徴付ける示強変数である温度をペアにしたときに圧力が定まると考え、
$ p = (T;V,N) $のように表し、それを状態方程式と呼ぶことにしよう、という導入をしている。

<P>

　他の教科書では、例えばモル数の変化は最初は気にせず、$ f(p,T,V) = 0 $を状態方程式と呼ぼうだとか、$ T = f(p,V) $を状態方程式と呼ぼうだとか
割と好き勝手に導入してあり、3 つの変数$ p,V,T $が互いに対等な扱いを受けていたりする。

\note{　このサイトの熱力学の解説も同じようなもので、状態方程式の中に (p,V,T) の 3 つの変数があるのだから
そのうちの二つを決めれば全部決まるよね、という楽観的な考えだけであとはひたすら公式を導いていくスタイルである。
単純なところはいいのだが、熱力学の全体像を問い質されると答えに窮するという弱点がある。}

　横道に逸れてしまっているが、話の方向はかなり前からほとんど変化していないし、進んでもいない。
この辺りは私が迷った期間の長さを表していると思ってほしい。

<P>

　だいたい次のような考えが固まりつつある。
3 つの変数を 1 つの方程式で縛ることで 2 つ分の自由度を持つ系ができており、
それに対してエネルギー保存則を満たす形で熱や仕事を外から加えて操作しようというのが熱力学の構造だと考えていいだろう。

<P>

　そういうわけで、気体の状態は例えば$ p\,\text{-}\,V $グラフという 2 自由度を持つ平面の上に表されるし、
エネルギー保存は、それらを表す変数とは別に導入された仕事や熱などを含めた上で成り立つものなので、
気体の状態がこの平面上のどこに行こうとあまり関係なく常に成り立っている。

<P>

　さて、流体力学に話を戻すと、
今欲しいのは流体の状態を表す未知関数の自由度を一つ減らすような方程式なのだった。
ある未知変数と、もう一つの未知変数がともに変化するとき、その変化の関係がどうなっているかを定めて欲しいのである。
熱力学を絡めて何とか解決しようとした場合、
流体の熱力学的状態が変化する範囲を$ p\,\text{-}\,V $グラフの平面全体で許したのではだめで、
何らかの一本の曲線上に制限するようなことが必要になる。

<P>

　エネルギー保存則にはその役割を果たすことは無理であって、
その物質がどんな制限に従って変化するものであるのかを別途定めてやらなければならないことになる。
「等温変化」か「等圧変化」か「等エントロピー変化」なのか、そういう条件が必要になるのである。

\note{　しかし等圧という条件では流体を駆動できないので無理だろう。
流体を動かすのは圧力差だからである。
いや、温度差を与えて流体の密度を変えて浮力の差で動かすようなことは可能かもしれないな。}

　そういうことであれば、エネルギー保存の式を使うよりもそれに合った状態方程式を使った方が手っ取り早い。
流体力学の未知関数として既に出てきている密度$ \rho $と圧力$ p $の関係だけを使えばいいのである。

<P>

　エネルギー保存の式は、もしどうしてもそちらが必要だという状況があれば、
熱力学の法則をあてはめて変数を減らして使うか、
増えてしまった未知関数に見合うだけの方程式をさらに追加して使うことになるだろう。

\note{　この解説ではごく基本的な流体の運動に絞って話を進めているが、
例えば、気象シミュレーションで使う条件式はかなり多い。
Wikipediaの「<a href="https://ja.wikipedia.org/wiki/%E3%83%97%E3%83%AA%E3%83%9F%E3%83%86%E3%82%A3%E3%83%96%E6%96%B9%E7%A8%8B%E5%BC%8F">プリミティブ方程式</a>」を参照のこと。}


　とまぁ、こういう考察を経て、少々不安を抱いたまま最初の方の話につながるのである。


% ===========================================================

\section{追記}

　この記事を公開したあとで、続きの記事（全体のまとめ）を書いていたらさらに考えがまとまったので、
それを追記という形でここに書き加えておこう。

<P>

　バロトロピー流体という仮定を (1) 式のような形で表したわけだが、
もし密度$ \rho $が圧力だけでなく温度にも依存するとしたら次の形で表されることになるだろう。

<tex>
\rho \ =\ \rho(p,T) \tag{8}
</tex>

　密度は体積と同じ意味なのだから、これは状態方程式そのものである。
教科書などで (1) 式を状態方程式と呼んでいることがあるので少し違和感があったが、
そう考えると (1) 式は状態方程式の特別な場合だと言ってもいいだろう。
確かに、特別な条件下での状態方程式であると言われてみればまぁその通りだ。

<P>

　さて、私はこれまで状態方程式と呼ばれている (1) 式とエネルギー保存の式のどちらを
どういう場合に使えばいいのだろう、という二者択一的な悩み方をしてきたのだった。
ところが視野を広げてみるといいことがあるものである。
「電磁流体力学」や「気象予測のシミュレーション」ではどういう式を使っているのだろうと眺めていたところ、
(8) 式の意味での状態方程式とエネルギー保存の式を両方とも使っているのを見た。

\note{　これまでも見たことはあるし知ってはいたのだが、当事者意識に欠けていたと弁解しておこう。}

　これは上の方で自分の口で必死に話していることと何ら矛盾しないのだが、それでもしばらくは奇妙な感じが続いた。
どちらかの式を選択しなければならない、選択は最も効率的に行われなければならないという思い込みが強すぎたのだろう。
そして頭の中が急に切り替わった。
二つの式は両立できるのだ、そういう使い方でも何ら問題ないのだ、と納得した瞬間である。

\note{　おそらく、未知関数の数と方程式の数をぴったり合わせなければならない、ということから、
むやみに方程式を加えればいいものではない、慎重にならなければ、という具合に考えが凝り固まっていったのだろう。
それも大事なことではあるのだ。}

　流体力学の入門書で多くの場合に (1) 式だけで済んでいるのは、
たまたまエネルギー保存の式を同時に持ち出さなくてもいいくらいの、
しかも持ち出すと余計にややこしくなってしまうような単純な状況に限って議論しているからなのだろう。


