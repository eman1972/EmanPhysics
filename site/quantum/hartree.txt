\field{量子力学}
\title{ハートリー近似}
\comment{使ってみたことがないゆえ、疑問噴出。}
\prev{variational}
\next{hartree2}
\create{2019/4/4 15:20}
\modify{}


\section{まずは言葉だけで内容説明}

　ハートリー近似とは、多電子原子のシュレーディンガー方程式を解くための近似解法の一つである。

<P>

　ハートリー近似のことを「平均場近似」と呼んだり「自己無撞着場の方法」と呼んだりすることがあるが、
それは、ハートリー近似が「平均場近似」や「自己無撞着場の方法」や「変分法」を採用している有名な手法だからである。
　「平均場近似」を採用している手法は他にもあるし、「自己無撞着場の方法」も一つではない。

\note{　「ハートリー近似」を改良した「ハートリーフォック近似」という手法もあるが、それは次の次あたりの記事で説明する予定である。}

　「自己無撞着」という用語は日常ではあまり使わないので、いかにも専門用語的なかっこよさがある。
　無撞着というのは無矛盾と同じ意味だから、分かりやすく言えば「自己矛盾を起こしていない」という意味だ。
　「自己無撞着場 (self-consistent field)」のことを「つじつまの合う場」と訳している教科書もある。

<P>

　まずは簡単に計算手法の方針を話してしまおう。

<P>

　多電子原子についてのシュレーディンガー方程式を解きたい場合に、
とりあえず一つの電子だけに注目して、残りの多数の電子からの影響をひとまとめに近似してしまうと楽そうである。
　そのためには注目している電子以外の電子の存在確率の分布を使って「\red{平均化した}」ポテンシャルを作るといいだろう。
　ところが、その分布はまだ計算していないので分からない。
　今はまだその多数の電子の中の最初の一つの軌道を計算するための作戦を練っていたところである。
　シュレーディンガー方程式の解である波動関数というのは、電子の存在確率の分布に他ならないのだ！
　\red{問題を解くために、問題の答えが先に必要になってしまうという状況だ。}

<P>

　そこで思い付くのは、それっぽい間に合わせの解を当てはめて計算してみることだ。
　出来るだけ正解に近いといいのだが、もちろん最初からそううまくは行かないだろう。
　その結果として仮の解が得られるが、それは間に合わせで使ってみた解とは当然違っている。
　その得られた解を使ってもう一度計算してみる。
　また解が得られる。
　まだ少しずれている。
　もう一度それを使って計算してみる。
　そういうことを繰り返していけば、そのうちに、使った解と出てきた解が似てきて、矛盾が無くなることだろう。
　矛盾が無くなるまでやるのである。
　いや、完全に一致させるのは難しいので、ある程度「\red{矛盾が解消されるまで}」続けるということになる。

<P>

　本当にそんなことで矛盾が解消されるのか？と思うかも知れないが、うまく行くような気もする。
　もし正解から大きくずれていたら仮の解とは全く違った解が出てくるわけであるから、自ずと次回は仮定を大きく変更することになっている。
　そのうちにたまたま正解に近付けば、その直前の仮定とはあまり変わらない結果が出てくるわけで、次回の修正はごくわずかとなるわけだ。
　こうして徐々に一定の解に落ち着くのではないだろうか？
　楽観的すぎるだろうか？

<P>

　この計算をするためには仮定として電子の数と同じだけの異なる軌道をあらかじめ用意してやる必要があるし、
次回の計算に当てはめるために電子の数と同じだけの計算結果を得る必要がある。
　つまり毎回、電子の数と同じ数の連立方程式を解くことになるのである。

<P>

　その解き方としては前回の記事で説明した「\red{変分法}」を使うことが多い。
　解の候補となる関数に自由なパラメータを仕込んでおいてハミルトニアンの期待値を計算し、それが最小値になるような条件を探るのである。
　得た結果を使って次回のハミルトニアンを作るわけだから、毎回微妙に違った問題に対して変分法を適用することになる。
　計算を繰り返してもパラメータの値がほとんど変化しなくなれば計算終了と判断できるわけだ。
　\red{ただし、必ずしも変分法を使わなければいけないわけではない。}

<P>

　これでおおよその計算内容のイメージがわいたのではなかろうか。
　「平均場近似」の使い所と「自己無撞着場」と呼ばれる意味と「変分法」をどう利用するかを話に入れておいた。
　ではそろそろ、具体的な説明に入ろう。


% =======================================================================

\section{具体的な計算内容}

　解こうとしているシュレーディンガー方程式は次のような形である。

<tex>
\hat{H} \, \psi \ =\ E \, \psi \tag{1}
</tex>

　座標原点に電荷$ +Ze $の原子核があって、その周囲に$ N $個の電子が存在している時、ハミルトニアンは次のようになる。

<tex>
\hat{H} \ =\ \sum_{i=1}^N \left( -\frac{\hbar^2}{2m}  \nabla^2_i \ -\ \frac{1}{4\pi \varepsilon\sub{0}} \frac{Ze^2}{|\Vec{x}_i|} \right) \ +\ \sum_{i=1}^N \sum_{j=i+1}^{N} \frac{1}{4\pi \varepsilon\sub{0}} \frac{e^2}{|\Vec{x}_i-\Vec{x}_j|} \tag{2}
</tex>

　つまり、$ N $個の電子の運動エネルギーと、それぞれが原子核に引かれる引力ポテンシャル、
そして全ての電子間の斥力ポテンシャルの合計が入っている。
　これをそのまま解くのはあまりに絶望的なので、何とかして単純化したいのである。

<P>

　まず、一つ一つの電子の状態は独立であると仮定しよう。
　つまり、それぞれの電子の存在確率を$ \varphi_i(\Vec{x}_i) $という関数で表せるものとする。
　これは、全体の状態$ \psi $がこれらの積として次のように表せると言っているのと同じである。

<tex>
\psi \ =\ \varphi\sub{1}(\Vec{x}\sub{1})\,\varphi\sub{2}(\Vec{x}\sub{2}) \cdots \varphi\sub{N}(\Vec{x}\sub{N}) \tag{3}
</tex>

　この仮定によって楽になることが二つある。
　一つは、このあとで電子の分布を平均化する近似計算が楽に実行できるということ。
　電子一つごとに分けて考えることができる。
　もう一つの狙いは、多数の「1 電子のシュレーディンガー方程式」に分解して計算することである。
　$ N $個のそれほど複雑でないシュレーディンガー方程式を解いてやって、
(3) 式によって最終的に一つの波動関数とすれば、解を得たことになる。

<P>

　(1) ～ (3) 式を使って$ \varphi_i(\Vec{x}_i) $が満たす方程式を導けたらいいのだが、(2) 式の最後の項はなかなか複雑で簡単には分けられない。
　\red{実はこの部分こそがハートリー近似の理論的な核心なのだが、説明が長くなってしまうし、実用的には必要ないので省略しよう。}
　（次回の記事でこの部分だけを説明し直す予定である。）
　代わりに物理的なイメージを頼りにして式を立ててもいい。
　次のようなシュレーディンガー方程式が組み上がる。

<tex>
\left( -\frac{\hbar^2}{2m}  \nabla^2_i \ -\ \frac{1}{4\pi \varepsilon\sub{0}} \frac{Ze^2}{|\Vec{x}_i|} \ +\ \sum_{i\neq j} \frac{1}{4\pi \varepsilon\sub{0}} \frac{e^2}{|\Vec{x}_i-\Vec{x}_j|} \right) \varphi_i(\Vec{x}_i) \ =\ \varepsilon_i \, \varphi_i(\Vec{x}_i) \tag{4}
</tex>

　この左辺のカッコの中の第 2 項は原子核の引力ポテンシャルであり、第 3 項は他の電子との斥力を表すポテンシャルである。
　座標変数が$ \Vec{x}_i $だけの方程式に出来たら楽だったのだが、第 3 項に他の電子の位置を表す$ \Vec{x}_j $が含まれているのが厄介である。
　この第 3 項を何とかして$ \Vec{x}_j $を含まない形に書き換えることを考えよう。
　$ j $番目の電子は位置$ \Vec{x}_j $付近に$ |\varphi_j(\Vec{x}_j)|^2 \diff \Vec{x}_j $という確率で存在しているのだから、
そういうぼんやりと分布した電荷によるポテンシャルの合計を次のような積分で表してやれる。

<tex>
V_i(\Vec{x}_i) \ =\ \sum_{j \neq i} \frac{e^2}{4\pi \varepsilon\sub{0}} \int  \frac{|\varphi_j(\Vec{x}_j)|^2}{|\Vec{x}_i-\Vec{x}_j|} \diff \Vec{x}_j \tag{5}
</tex>

　積分範囲は全空間である。
　$ \varphi_j(\Vec{x}_j) $があらかじめ具体的に分かっていれば、この計算をした結果からは$ \Vec{x}_j $が消える。
　つまり、$ \Vec{x}_i $だけの関数で表されたポテンシャル$ V_i(\Vec{x}_i) $が得られる。

<P>

　しかしまだ実際に解くには難しさが残る。
　電子の存在確率は球対称になっているとは限らないから$ V_i(\Vec{x}_i) $も複雑な形になっているであろう。
　そこでさらに大胆な近似を取り入れることにする。
　原点からの半径$ |\Vec{x}_i| $が同じであるような地点の$ V_i(\Vec{x}_i) $の値を平均化してしまって無理やり球対称ポテンシャル$ V_i(|\Vec{x}_i|) $にしてしまうのである。
　その計算内容を数式で表そうとすると極座標で表し直さないといけないのだが、それほど難しい操作ではない。

<P>

　難しくないと言った手前、手早くやってみせよう。
　$ V_i(\Vec{x}_i) $を極座標で表した関数を$ V_i(r,\theta,\phi) $と表記する。
　半径$ r $の球殻上の微小表面積$ r^2 \sin \theta \diff \theta \diff \phi $を掛けて積分したあとで、球殻全体の表面積$ 4\pi r^2 $で割れば平均したことになる。

<tex>
V_i(|\Vec{x}_i|) \ &=\ \frac{1}{4\pi r^2} \int_0^{2\pi} \int_0^\pi V_i(r,\theta,\phi) r^2 \sin \theta \diff \theta \diff \phi \\
&=\ \frac{1}{4\pi} \int_0^{2\pi} \int_0^\pi V_i(r,\theta,\phi) \sin \theta \diff \theta \diff \phi \tag{6}
</tex>

　ここで$ r $を使ったが、$ |\Vec{x}_i| $と$ r $は同じものである。
　だから$ V_i(|\Vec{x}_i|) $の代わりに$ V_i(r) $と書いた方が分かりやすいかも知れない。
　そのように作った球対称ポテンシャルで (4) 式の一部を置き換えてやって、次のような式を作る。

<tex>
\left( -\frac{\hbar^2}{2m}  \nabla^2_i \ -\ \frac{1}{4\pi \varepsilon\sub{0}} \frac{Ze^2}{r} \ +\ V_i(r) \right) \varphi_i(\Vec{x}_i) \ =\ \varepsilon_i \, \varphi_i(\Vec{x}_i) \tag{7}
</tex>

　この式を「\red{ハートリー方程式}」と呼ぶ。
　この左辺のカッコ内の第 2 項と第 3 項はどちらも球対称ポテンシャルなので一緒にしてやって「1 電子の球対称ポテンシャルの問題」として解くことができる。
　つまり、水素原子のシュレーディンガー方程式を解いたときと同じ要領で変数分離してやって解くことができる。
　方向に依存する解は水素原子のときと同じ球面調和関数であり、
あとは動径方向$ r $についての 1 次元のシュレーディンガー方程式を解くだけで良い。

<P>

　結局、我々がやるべき計算の手順は次のようになる。
　まず何らかの$ \varphi_j(\Vec{x}_j) $を電子の数だけ仮定してやって、
それらを使って (5) 式と (6) 式の操作を続けて行うことで$ V_i(r) $を電子の数だけ作り、それらを使って多数の (7) 式を解く。
　解けば多数の$ \varphi_j(\Vec{x}_j) $が得られるから、それらを使って再び  (5) 式と (6) 式の操作を続けて行い、同じことを繰り返す。
　繰り返すうちに、やがて解の形が変化しなくなれば終了である。

% =======================================================================

\section{雑談}

　記事を書いていて幾つか気になることが出てきた。
　シュレーディンガー方程式の解は一つではなく、複数のエネルギー固有値と固有関数が出てくるのだった。
　(7) 式を解いたときにも複数の解が出てくるだろうが、
採用すべきなのはその中の一体どれだろうか？
　エネルギーが最低であるような解ばかりを選んでも良いものだろうか？

<P>

　方向に依存する解としては球面調和関数が出てくるようなので、
なるべく現実の原子を表す解に近付けたければ、
方位量子数$ l $や磁気量子数$ m $の値がそれぞれ異なるように解を採用すべきなのだろう。
　近似解法だということもあり、人為的な解の選択が必要であって、選び方によっては全く役に立たない解も出てきそうである。

<P>

　もし役に立たない解、つまり、現実とは掛け離れた解が得られたとして、その解は全く意味がないのだろうか？
　それとも、その解は何らかの許される解の一つではあると言えるのだろうか？
　そういうところも気になる。

<P>

　いや、待てよ？
　「つじつまの合う場」だとは言っているけれども、
毎回球面調和関数で表される解が出てきているのを無理やり球対称ポテンシャルに直したものを使って次の計算しているのだから、
実際にはつじつまが合っておらず、解としてはかなり怪しいわけか。
　よし、この件はとりあえず納得した。

<P>


　さらに気になることがある。
　(7) 式を変数分離した後の動径方向についての方程式は解析的には解くことは難しいので、コンピュータを使った数値解法に頼ることになるだろう。
　しかしハートリー近似の手法はまだ電子計算機が発明される以前(1928)に発表されている。
　最初の頃には一体どのような使い方がされたというのだろうか？

<P>

　ちょっと調べてみると、この近似解法を発表したダグラス・ハートリーはもともと紙と鉛筆だけで微分方程式を解く技に秀でていたらしい。
　そして微分解析機（機械仕掛けのアナログコンピュータ）を開発していたようである。
　それを使って様々な問題に取り組んだり、さらなる応用の可能性を探っていた。
　電子計算機が登場した後はそちらにも深い関心を寄せ、性能の向上に合わせて色々な計算手法を試したようである。

<P>

　というわけで、この手法を少しも自分で試してみもしないでこんな記事を書いている私は本当に罰当たりだということが分かった。
　先人たちは今からでは考えられないほどの努力をしていたのだろう。

<P>

　今の時代、数値計算をわざわざ紙と鉛筆でやるような理由は無さそうだし、そのような根性は私にはまるでないが、
変分法を使うのなら紙と鉛筆でも何とかなるような気もする。
　ごく単純な形の試行関数を選んで (7) 式の左辺にあるようなハミルトニアンを使ってエネルギー期待値を計算してやって、
その値が最小になるようなパラメータ調整をするわけだ。
　しかしその手間を想像してみると、やっぱり紙と鉛筆で実行するのは嫌だなと思える。

<P>

　変分法を使った場合に出てくる解は本当の解とは限らないというのはよく分かるから、
先ほどのような「得られた解に数学的な意味があるか」というような疑問は少しも感じない。

<P>

　しかし変分法というのはエネルギーが最低となるような解を探す手法であった。
　パラメータをどう変化させても互いに直交したままであるような試行関数をあらかじめ選んでおかないと、
どの電子の関数も基底状態を目指してしまって、うまく行かないのではないだろうか？
　ハートリー近似の最初の仮定である (3) 式では、
それぞれの電子の状態を表す関数$ \varphi_i(\Vec{x}_i) $は自由に選んでも良くて、互いに直交していなくても構わないことになっていた。
　そこを改良すればもう少し現実に近い解が得られるのではないだろうか？

<P>

　その辺りを説明する記事も近い内に書く予定だが、それが「ハートリー・フォック近似」である。

<P>

　ここまで書いてきて、やっと気付いたことがある。
　私はこれまで、この一連の計算手法の全体のことを「ハートリー近似」と呼ぶのだと思いこんでいたのだが、
その中でも (3) 式の仮定がもっとも重要であり、\red{狭い意味では (3) 式のことだけを指して「ハートリー近似」と呼ぶことがあるらしい。}

<P>

　実は (1) ～ (3) 式があればあとは数学的な操作によって (4) 式どころか (5) 式まで自動的にたどり着けるのであり、
他の電子の存在確率を考慮したポテンシャルを作るというのさえ、(3) 式の仮定の中にすでに含まれていたのだ。
　道理で一見不要に思える (3) 式を省略することなくわざわざ大事なことのように書いてある教科書が多いわけだ。
　しかし (6) 式によって球対称ポテンシャルに置き換えるという近似は (3) 式とは独立に導入した近似だと言えるだろう。



